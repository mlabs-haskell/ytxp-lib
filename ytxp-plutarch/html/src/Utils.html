<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Utils</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>  </span><span class="annot"><a href="Utils.html#pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount"><span class="hs-identifier">pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="annot"><a href="Utils.html#phasOneScriptInputAtValidatorWithExactlyOneToken"><span class="hs-identifier">phasOneScriptInputAtValidatorWithExactlyOneToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Utils.html#phasOnlyOneValidScriptOutputWithToken"><span class="hs-identifier">phasOnlyOneValidScriptOutputWithToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Utils.html#phasOnlyOneInputWithExactlyOneTokenWithSymbol"><span class="hs-identifier">phasOnlyOneInputWithExactlyOneTokenWithSymbol</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Utils.html#phasNoScriptInputWithToken"><span class="hs-identifier">phasNoScriptInputWithToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="Utils.html#poutputsDoNotContainToken"><span class="hs-identifier">poutputsDoNotContainToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Utils.html#pemptyTokenName"><span class="hs-identifier">pemptyTokenName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="Utils.html#pands"><span class="hs-identifier">pands</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="Utils.html#pscriptHashToCurrencySymbol"><span class="hs-identifier">pscriptHashToCurrencySymbol</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Utils.html#punsafeFromInlineDatum"><span class="hs-identifier">punsafeFromInlineDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Utils.html#pmember"><span class="hs-identifier">pmember</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html"><span class="hs-identifier">Cardano.YTxP.Control.YieldList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html#PYieldListDatum"><span class="hs-identifier">PYieldListDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html#PYieldListDatum"><span class="hs-identifier">PYieldListDatum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier">nonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/Numeric.Natural.html"><span class="hs-identifier">Numeric.Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/ghc-bignum-1.3/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Api.V1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PCredential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PPubKeyCredential</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PScriptCredential</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Api.V1.Value</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-identifier">PCurrencySymbol</span></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-identifier">PTokenName</span></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-identifier">PValue</span></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-identifier">padaSymbol</span></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-identifier">pvalueOf</span></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Api.V2</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-identifier">AmountGuarantees</span></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-identifier">KeyGuarantees</span></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-identifier">PMap</span></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-identifier">POutputDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">POutputDatum</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-identifier">PScriptHash</span></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-identifier">PTxInInfo</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-identifier">PTxOut</span></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="hs-identifier">PTxOutRef</span></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Extra.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pkeys</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pfoldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">punsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">{- | Like Haskell's `and` but for Plutarch terms
`Plutarch.Bool` has the same function but does not export it.
-}</span></span><span>
</span><span id="line-44"></span><span id="local-6989586621679271131"><span class="annot"><a href="Utils.html#pands"><span class="hs-identifier hs-type">pands</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271131"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271131"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span></span><span>
</span><span id="line-45"></span><span id="pands"><span class="annot"><span class="annottext">pands :: forall (s :: S). [Term s PBool] -&gt; Term s PBool
</span><a href="Utils.html#pands"><span class="hs-identifier hs-var hs-var">pands</span></a></span></span><span> </span><span id="local-6989586621679271408"><span class="annot"><span class="annottext">[Term s PBool]
</span><a href="#local-6989586621679271408"><span class="hs-identifier hs-var">ts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Term s PBool] -&gt; Maybe (NonEmpty (Term s PBool))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[Term s PBool]
</span><a href="#local-6989586621679271408"><span class="hs-identifier hs-var">ts'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NonEmpty (Term s PBool))
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PBool s -&gt; Term s PBool
forall (a :: PType) (s :: S). PlutusType a =&gt; a s -&gt; Term s a
</span><span class="hs-identifier hs-var">pcon</span></span><span> </span><span class="annot"><span class="annottext">PBool s
forall (s :: S). PBool s
</span><span class="hs-identifier hs-var">PTrue</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679271411"><span class="annot"><span class="annottext">NonEmpty (Term s PBool)
</span><a href="#local-6989586621679271411"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Term s PBool -&gt; Term s PBool -&gt; Term s PBool)
-&gt; NonEmpty (Term s PBool) -&gt; Term s PBool
forall a. (a -&gt; a -&gt; a) -&gt; NonEmpty a -&gt; a
forall (t :: Type -&gt; Type) a.
Foldable t =&gt;
(a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PBool -&gt; Term s PBool -&gt; Term s PBool
forall (s :: S). Term s PBool -&gt; Term s PBool -&gt; Term s PBool
</span><span class="hs-operator hs-var">(#&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Term s PBool)
</span><a href="#local-6989586621679271411"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">{- | Check that none of the given outputs contain a token
with the given `PCurrencySymbol`
-}</span></span><span>
</span><span id="line-53"></span><span id="local-6989586621679271144"><span class="annot"><a href="Utils.html#poutputsDoNotContainToken"><span class="hs-identifier hs-type">poutputsDoNotContainToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271144"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PBuiltinList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxOut</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271144"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-56"></span><span id="poutputsDoNotContainToken"><span class="annot"><span class="annottext">poutputsDoNotContainToken :: forall (s :: S).
Term s (PBuiltinList PTxOut) -&gt; Term s (PCurrencySymbol :--&gt; PBool)
</span><a href="Utils.html#poutputsDoNotContainToken"><span class="hs-identifier hs-var hs-var">poutputsDoNotContainToken</span></a></span></span><span> </span><span id="local-6989586621679271484"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut)
</span><a href="#local-6989586621679271484"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s PBool) -&gt; Term s (c :--&gt; PBool)
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol -&gt; Term s PBool)
 -&gt; Term s (PCurrencySymbol :--&gt; PBool))
-&gt; (Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271486"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679271486"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut)
-&gt; (PBuiltinList PTxOut s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-59"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PTxOut :--&gt; PBool)
   :--&gt; (PBuiltinList PTxOut :--&gt; PBuiltinList PTxOut))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><span class="hs-identifier hs-var">pfilter</span></span><span class="hs-cpp">
          # plam
</span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txOut</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-62"></span><span>                </span><span class="hs-identifier">pconstant</span><span> </span><span class="hs-number">0</span><span class="hs-cpp">
                  #&lt; (
</span><span>                       </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-65"></span><span>                       </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">valueMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-66"></span><span>                            </span><span class="hs-identifier">pto</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-67"></span><span>                              </span><span class="hs-identifier">pto</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-68"></span><span>                                </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-69"></span><span>                                  </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;value&quot;</span><span class="hs-cpp">
                                    # txOut
</span><span>                           </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pfix</span><span> </span><span class="hs-operator">#$</span><span> </span><span class="hs-identifier">plam</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">self</span><span> </span><span class="hs-identifier">valueMap'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-72"></span><span>                            </span><span class="hs-identifier">pelimList</span><span>
</span><span id="line-73"></span><span>                              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">symbolAndTokens</span><span> </span><span class="hs-identifier">rest</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-74"></span><span>                                  </span><span class="hs-identifier">pif</span><span>
</span><span id="line-75"></span><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">symbol</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>                                    </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">pfoldl'</span><span>
</span><span id="line-78"></span><span>                                            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>                                                </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span class="hs-special">)</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-80"></span><span>                                            </span><span class="hs-special">)</span><span class="hs-cpp">
                                            # 0
</span><span class="hs-cpp">                                            # tokens
</span><span>                                    </span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier">self</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                              </span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>                              </span><span class="hs-number">0</span><span>
</span><span id="line-87"></span><span>                              </span><span class="hs-identifier">valueMap'</span><span>
</span><span id="line-88"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">valueMap</span><span>
</span><span id="line-89"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>            </span><span class="hs-special">)</span><span class="hs-cpp">
          # outputs
</span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">((PBuiltinList PTxOut s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBuiltinList PTxOut s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-comment">-- Check that the filtered list is empty</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxOut s
</span><span class="hs-identifier hs-var">PNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxOut s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- Check that none of the inputs in the given list</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- contain one or more tokens with the given `PCurrencySymbol`</span><span>
</span><span id="line-100"></span><span id="local-6989586621679271264"><span class="annot"><a href="Utils.html#phasNoScriptInputWithToken"><span class="hs-identifier hs-type">phasNoScriptInputWithToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271264"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PBuiltinList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxInInfo</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271264"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-103"></span><span id="phasNoScriptInputWithToken"><span class="annot"><span class="annottext">phasNoScriptInputWithToken :: forall (s :: S).
Term s (PBuiltinList PTxInInfo)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
</span><a href="Utils.html#phasNoScriptInputWithToken"><span class="hs-identifier hs-var hs-var">phasNoScriptInputWithToken</span></a></span></span><span> </span><span id="local-6989586621679271614"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679271614"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s PBool) -&gt; Term s (c :--&gt; PBool)
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol -&gt; Term s PBool)
 -&gt; Term s (PCurrencySymbol :--&gt; PBool))
-&gt; (Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271615"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679271615"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
-&gt; (PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PTxInInfo :--&gt; PBool)
   :--&gt; (PBuiltinList PTxInInfo :--&gt; PBuiltinList PTxInInfo))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><span class="hs-identifier hs-var">pfilter</span></span><span class="hs-cpp">
          # plam
</span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txInInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>                </span><span class="hs-identifier">pmatch</span><span>
</span><span id="line-110"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">pfromData</span><span>
</span><span id="line-111"></span><span>                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;credential&quot;</span><span class="hs-cpp">
                        #$ pfromData
</span><span>                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;address&quot;</span><span class="hs-cpp">
                        #$ pfromData
</span><span>                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txInInfo</span><span>
</span><span id="line-116"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                  </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-118"></span><span>                    </span><span class="hs-comment">-- Check the output is a script output,</span><span>
</span><span id="line-119"></span><span>                    </span><span class="hs-comment">-- if so check that the output contains one or more YieldListSTT</span><span>
</span><span id="line-120"></span><span>                    </span><span class="hs-identifier">PScriptCredential</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">pconstant</span><span> </span><span class="hs-number">0</span><span class="hs-cpp">
                          #&lt; (
</span><span>                               </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-124"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">valueMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>                                    </span><span class="hs-identifier">pto</span><span>
</span><span id="line-126"></span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pto</span><span>
</span><span id="line-127"></span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfromData</span><span>
</span><span id="line-128"></span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;value&quot;</span><span class="hs-cpp">
                                        #$ pfromData
</span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span class="hs-cpp">
                                        # txInInfo
</span><span>                                   </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pfix</span><span> </span><span class="hs-operator">#$</span><span> </span><span class="hs-identifier">plam</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">self</span><span> </span><span class="hs-identifier">valueMap'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>                                    </span><span class="hs-identifier">pelimList</span><span>
</span><span id="line-134"></span><span>                                      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">symbolAndTokens</span><span> </span><span class="hs-identifier">rest</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>                                          </span><span class="hs-identifier">pif</span><span>
</span><span id="line-136"></span><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">symbol</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                                            </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                                               </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">pfoldl'</span><span>
</span><span id="line-139"></span><span>                                                    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>                                                        </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span class="hs-special">)</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-141"></span><span>                                                    </span><span class="hs-special">)</span><span class="hs-cpp">
                                                    # 0
</span><span class="hs-cpp">                                                    # tokens
</span><span>                                            </span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier">self</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                                      </span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                                      </span><span class="hs-number">0</span><span>
</span><span id="line-148"></span><span>                                      </span><span class="hs-identifier">valueMap'</span><span>
</span><span id="line-149"></span><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">valueMap</span><span>
</span><span id="line-150"></span><span>                             </span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pconstant</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">)</span><span class="hs-cpp">
          # inputs
</span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">((PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxInInfo s
</span><span class="hs-identifier hs-var">PNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxInInfo s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">{- | Check that there is only token of given `PCurrencySymbol`
 and `PTokenName` with given amount contained in the given PValue.

 Note: We use this function when checking the `mint` field of `TxInfo`,
 as when checking `mint` we need to check that the length is equal to two
 to account for the additional 'zero Ada' entry automatically included in the `mint` field:
   (PCurrencySymbol 0x,PMap [(PTokenName 0x,0)])])
-}</span></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Utils.html#pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount"><span class="hs-identifier hs-type">pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679271272"><span class="annot"><a href="#local-6989586621679271272"><span class="hs-identifier hs-type">keys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyGuarantees</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679271273"><span class="annot"><a href="#local-6989586621679271273"><span class="hs-identifier hs-type">amounts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AmountGuarantees</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679271271"><span class="annot"><a href="#local-6989586621679271271"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="#local-6989586621679271271"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PValue</span></span><span> </span><span class="annot"><a href="#local-6989586621679271272"><span class="hs-identifier hs-type">keys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679271273"><span class="hs-identifier hs-type">amounts</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTokenName</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PInteger</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount"><span class="annot"><span class="annottext">pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount :: forall (keys :: KeyGuarantees) (amounts :: AmountGuarantees)
       (s :: S).
Term
  s
  (PValue keys amounts
   :--&gt; (PCurrencySymbol
         :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
</span><a href="Utils.html#pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount"><span class="hs-identifier hs-var hs-var">pmintFieldHasTokenOfCurrencySymbolTokenNameAndAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (PValue keys amounts
   :--&gt; (PCurrencySymbol
         :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
-&gt; Term
     s
     (PValue keys amounts
      :--&gt; (PCurrencySymbol
            :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><span class="hs-identifier hs-var">phoistAcyclic</span></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   (PValue keys amounts
    :--&gt; (PCurrencySymbol
          :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
 -&gt; Term
      s
      (PValue keys amounts
       :--&gt; (PCurrencySymbol
             :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool)))))
-&gt; ClosedTerm
     (PValue keys amounts
      :--&gt; (PCurrencySymbol
            :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
-&gt; Term
     s
     (PValue keys amounts
      :--&gt; (PCurrencySymbol
            :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">(Term s (PValue keys amounts)
 -&gt; Term s PCurrencySymbol
 -&gt; Term s PTokenName
 -&gt; Term s PInteger
 -&gt; Term s PBool)
-&gt; Term
     s
     (PValue keys amounts
      :--&gt; (PCurrencySymbol
            :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c
 -&gt; Term s PCurrencySymbol
 -&gt; Term s PTokenName
 -&gt; Term s PInteger
 -&gt; Term s PBool)
-&gt; Term
     s
     (c
      :--&gt; (PCurrencySymbol
            :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s (PValue keys amounts)
  -&gt; Term s PCurrencySymbol
  -&gt; Term s PTokenName
  -&gt; Term s PInteger
  -&gt; Term s PBool)
 -&gt; Term
      s
      (PValue keys amounts
       :--&gt; (PCurrencySymbol
             :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool)))))
-&gt; (Term s (PValue keys amounts)
    -&gt; Term s PCurrencySymbol
    -&gt; Term s PTokenName
    -&gt; Term s PInteger
    -&gt; Term s PBool)
-&gt; Term
     s
     (PValue keys amounts
      :--&gt; (PCurrencySymbol
            :--&gt; (PTokenName :--&gt; (PInteger :--&gt; PBool))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271653"><span class="annot"><span class="annottext">Term s (PValue keys amounts)
</span><a href="#local-6989586621679271653"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679271654"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679271654"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span id="local-6989586621679271655"><span class="annot"><span class="annottext">Term s PTokenName
</span><a href="#local-6989586621679271655"><span class="hs-identifier hs-var">tokenName</span></a></span></span><span> </span><span id="local-6989586621679271656"><span class="annot"><span class="annottext">Term s PInteger
</span><a href="#local-6989586621679271656"><span class="hs-identifier hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">Term
  s
  (PValue keys amounts
   :--&gt; (PCurrencySymbol :--&gt; (PTokenName :--&gt; PInteger)))
forall (s :: S) (anyKey :: KeyGuarantees)
       (anyAmount :: AmountGuarantees).
Term
  s
  (PValue anyKey anyAmount
   :--&gt; (PCurrencySymbol :--&gt; (PTokenName :--&gt; PInteger)))
</span><span class="hs-identifier hs-var">pvalueOf</span></span><span class="hs-cpp">
      # value
</span><span class="hs-cpp">      # symbol
</span><span class="hs-cpp">      # tokenName
</span><span class="hs-cpp">      #== amount
</span><span class="hs-cpp">      #&amp;&amp; (plength #$ pto $ pto $ pto value)
</span><span class="hs-cpp">      #== 2
</span><span>
</span><span id="line-188"></span><span class="annot"><span class="hs-comment">{- |
Check that:
  - there is exactly one script output with exactly one token
    with the given `PCurrencySymbol` and `PTokenName`
  - there is no other script output with one or more of these tokens
    (We do this in order to use this helper to ensure that there are no other
     script outputs containing one ore more of this token)
  - there is no wallet output that contains one of these tokens
  - if there is exactly one script output with exactly one of these tokens,
    we check that it contains no other tokens aside from Ada
  - finally check that the output also contains a valid (according to the spec) `POutputDatum`,
    ensuring the length of the yield list does not exceed the provided `maxYieldListSize` parameter.
-}</span></span><span>
</span><span id="line-201"></span><span id="local-6989586621679271287"><span class="annot"><a href="Utils.html#phasOnlyOneValidScriptOutputWithToken"><span class="hs-identifier hs-type">phasOnlyOneValidScriptOutputWithToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/ghc-bignum-1.3/src/GHC.Num.Natural.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271287"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PBuiltinList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxOut</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="#local-6989586621679271287"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span id="phasOnlyOneValidScriptOutputWithToken"><span class="annot"><span class="annottext">phasOnlyOneValidScriptOutputWithToken :: forall (s :: S).
Nat
-&gt; Term s (PBuiltinList PTxOut)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
</span><a href="Utils.html#phasOnlyOneValidScriptOutputWithToken"><span class="hs-identifier hs-var hs-var">phasOnlyOneValidScriptOutputWithToken</span></a></span></span><span> </span><span id="local-6989586621679271846"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621679271846"><span class="hs-identifier hs-var">maxYieldListSize</span></a></span></span><span> </span><span id="local-6989586621679271847"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut)
</span><a href="#local-6989586621679271847"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s PBool) -&gt; Term s (c :--&gt; PBool)
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol -&gt; Term s PBool)
 -&gt; Term s (PCurrencySymbol :--&gt; PBool))
-&gt; (Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271848"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679271848"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut)
-&gt; (PBuiltinList PTxOut s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PTxOut :--&gt; PBool)
   :--&gt; (PBuiltinList PTxOut :--&gt; PBuiltinList PTxOut))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><span class="hs-identifier hs-var">pfilter</span></span><span class="hs-cpp">
          # plam
</span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txOut</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>                </span><span class="hs-comment">-- Check the output contains one or more YieldListSTT.</span><span>
</span><span id="line-216"></span><span>                </span><span class="hs-comment">-- At this step, we want to find any output (wallet or script)</span><span>
</span><span id="line-217"></span><span>                </span><span class="hs-comment">-- that contains one or more YieldListSTT.</span><span>
</span><span id="line-218"></span><span>                </span><span class="hs-comment">-- This is to avoid needing another helper to check that there are no script outputs or</span><span>
</span><span id="line-219"></span><span>                </span><span class="hs-comment">-- wallet outputs containing one or more of these tokens.</span><span>
</span><span id="line-220"></span><span>                </span><span class="hs-identifier">pconstant</span><span> </span><span class="hs-number">0</span><span class="hs-cpp">
                  #&lt; (
</span><span>                       </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-223"></span><span>                       </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">valueMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pto</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;value&quot;</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">txOut</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                           </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pfix</span><span> </span><span class="hs-operator">#$</span><span> </span><span class="hs-identifier">plam</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">self</span><span> </span><span class="hs-identifier">valueMap'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>                            </span><span class="hs-identifier">pelimList</span><span>
</span><span id="line-226"></span><span>                              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">symbolAndTokens</span><span> </span><span class="hs-identifier">rest</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>                                  </span><span class="hs-identifier">pif</span><span>
</span><span id="line-228"></span><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">symbol</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>                                    </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">pfoldl'</span><span>
</span><span id="line-231"></span><span>                                            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>                                                </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span class="hs-special">)</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-233"></span><span>                                            </span><span class="hs-special">)</span><span class="hs-cpp">
                                            # 0
</span><span class="hs-cpp">                                            # tokens
</span><span>                                    </span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>                                    </span><span class="hs-special">(</span><span class="hs-identifier">self</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>                              </span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                              </span><span class="hs-number">0</span><span>
</span><span id="line-240"></span><span>                              </span><span class="hs-identifier">valueMap'</span><span>
</span><span id="line-241"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">valueMap</span><span>
</span><span id="line-242"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-special">)</span><span class="hs-cpp">
          # outputs
</span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><span class="annottext">((PBuiltinList PTxOut s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBuiltinList PTxOut s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-comment">-- Check that the resulting filtered list has exactly one element</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PCons</span></span><span> </span><span id="local-6989586621679271863"><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679271863"><span class="hs-identifier hs-var">txOut'</span></a></span></span><span> </span><span id="local-6989586621679271864"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut)
</span><a href="#local-6989586621679271864"><span class="hs-identifier hs-var">tailOfList</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>          </span><span class="annot"><span class="annottext">Term s PBool -&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut :--&gt; PBool)
forall (a :: PType) (s :: S).
PElemConstraint PBuiltinList a =&gt;
Term s (PBuiltinList a :--&gt; PBool)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
(PListLike list, PElemConstraint list a) =&gt;
Term s (list a :--&gt; PBool)
</span><span class="hs-identifier hs-var">pnull</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut :--&gt; PBool)
-&gt; Term s (PBuiltinList PTxOut) -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxOut)
</span><a href="#local-6989586621679271864"><span class="hs-identifier hs-var">tailOfList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PBool s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-250"></span><span>            </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PTrue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-251"></span><span>              </span><span class="hs-comment">-- If so then check that the output is a script output</span><span>
</span><span id="line-252"></span><span>              </span><span class="annot"><span class="annottext">Term s PCredential
-&gt; (PCredential s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PCredential) -&gt; Term s PCredential
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PCredential) -&gt; Term s PCredential)
-&gt; Term s (PAsData PCredential) -&gt; Term s PCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;credential&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAddress :--&gt; PAsData PCredential)
-&gt; Term s PAddress -&gt; Term s (PAsData PCredential)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#$</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PAddress) -&gt; Term s PAddress
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PAddress) -&gt; Term s PAddress)
-&gt; Term s (PAsData PAddress) -&gt; Term s PAddress
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;address&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxOut :--&gt; PAsData PAddress)
-&gt; Term s PTxOut -&gt; Term s (PAsData PAddress)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679271863"><span class="hs-identifier hs-var">txOut'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>                </span><span class="annot"><span class="annottext">((PCredential s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PCredential s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-255"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">PScriptCredential</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':) @PLabeledType (&quot;_0&quot; ':= PScriptHash) ('[] @PLabeledType)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>                    </span><span class="hs-comment">-- If there is only one output in the filtered result,</span><span>
</span><span id="line-257"></span><span>                    </span><span class="hs-comment">-- and that output is a script output,</span><span>
</span><span id="line-258"></span><span>                    </span><span class="hs-comment">-- then check that it contains exactly one token with the given symbol</span><span>
</span><span id="line-259"></span><span>                    </span><span class="annot"><span class="annottext">Term s PBool -&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-260"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-261"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679271866"><span class="annot"><span class="annottext">valueMap :: Term s (PInner (PInner (PValue 'Sorted 'Positive)))
</span><a href="#local-6989586621679271866"><span class="hs-identifier hs-var hs-var">valueMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PInner (PValue 'Sorted 'Positive))
-&gt; Term s (PInner (PInner (PValue 'Sorted 'Positive)))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PValue 'Sorted 'Positive)
-&gt; Term s (PInner (PValue 'Sorted 'Positive))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PValue 'Sorted 'Positive)
 -&gt; Term s (PInner (PValue 'Sorted 'Positive)))
-&gt; Term s (PValue 'Sorted 'Positive)
-&gt; Term s (PInner (PValue 'Sorted 'Positive))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PValue 'Sorted 'Positive))
-&gt; Term s (PValue 'Sorted 'Positive)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData (PValue 'Sorted 'Positive))
 -&gt; Term s (PValue 'Sorted 'Positive))
-&gt; Term s (PAsData (PValue 'Sorted 'Positive))
-&gt; Term s (PValue 'Sorted 'Positive)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxOut :--&gt; PAsData (PValue 'Sorted 'Positive))
-&gt; Term s PTxOut -&gt; Term s (PAsData (PValue 'Sorted 'Positive))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679271863"><span class="hs-identifier hs-var">txOut'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>                              </span><span id="local-6989586621679271867"><span class="annot"><span class="annottext">go :: Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679271867"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (((PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
    :--&gt; (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger)))
          :--&gt; PInteger))
   :--&gt; (PBuiltinList
           (PBuiltinPair
              (PAsData PCurrencySymbol)
              (PAsData (PMap 'Sorted PTokenName PInteger)))
         :--&gt; PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (((a :--&gt; b) :--&gt; (a :--&gt; b)) :--&gt; (a :--&gt; b))
</span><span class="hs-identifier hs-var">pfix</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (((PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
    :--&gt; (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger)))
          :--&gt; PInteger))
   :--&gt; (PBuiltinList
           (PBuiltinPair
              (PAsData PCurrencySymbol)
              (PAsData (PMap 'Sorted PTokenName PInteger)))
         :--&gt; PInteger))
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger)))
      :--&gt; PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#$</span></span><span> </span><span class="annot"><span class="annottext">(Term
   s
   (PBuiltinList
      (PBuiltinPair
         (PAsData PCurrencySymbol)
         (PAsData (PMap 'Sorted PTokenName PInteger)))
    :--&gt; PInteger)
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term
     s
     (c
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term
    s
    (PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
  -&gt; Term
       s
       (PBuiltinList
          (PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap 'Sorted PTokenName PInteger))))
  -&gt; Term s PInteger)
 -&gt; Term
      s
      ((PBuiltinList
          (PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap 'Sorted PTokenName PInteger)))
        :--&gt; PInteger)
       :--&gt; (PBuiltinList
               (PBuiltinPair
                  (PAsData PCurrencySymbol)
                  (PAsData (PMap 'Sorted PTokenName PInteger)))
             :--&gt; PInteger)))
-&gt; (Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
    -&gt; Term
         s
         (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger))))
    -&gt; Term s PInteger)
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271868"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679271868"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679271869"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679271869"><span class="hs-identifier hs-var">valueMap'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>                                </span><span class="annot"><span class="annottext">(Term
   s
   (PBuiltinPair
      (PAsData PCurrencySymbol)
      (PAsData (PMap 'Sorted PTokenName PInteger)))
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term s PInteger
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (a :: PType) (s :: S) (r :: PType).
PElemConstraint PBuiltinList a =&gt;
(Term s a -&gt; Term s (PBuiltinList a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (PBuiltinList a) -&gt; Term s r
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
(PListLike list, PElemConstraint list a) =&gt;
(Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (list a) -&gt; Term s r
</span><span class="hs-identifier hs-var">pelimList</span></span><span>
</span><span id="line-264"></span><span>                                  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271870"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679271870"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span></span><span> </span><span id="local-6989586621679271871"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679271871"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>                                      </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s PInteger -&gt; Term s PInteger -&gt; Term s PInteger
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><span class="hs-identifier hs-var">pif</span></span><span>
</span><span id="line-266"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PCurrencySymbol) -&gt; Term s PCurrencySymbol
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData PCurrencySymbol)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; a)
</span><span class="hs-identifier hs-var">pfstBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData PCurrencySymbol)
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
-&gt; Term s (PAsData PCurrencySymbol)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679271870"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol -&gt; Term s PCurrencySymbol -&gt; Term s PBool
forall (s :: S).
Term s PCurrencySymbol -&gt; Term s PCurrencySymbol -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><span class="hs-operator hs-var">#==</span></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679271848"><span class="hs-identifier hs-var">symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>                                        </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679271872"><span class="annot"><span class="annottext">tokens :: Term s (PInner (PInner (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679271872"><span class="hs-identifier hs-var hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PInner (PMap 'Sorted PTokenName PInteger))
-&gt; Term s (PInner (PInner (PMap 'Sorted PTokenName PInteger)))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PMap 'Sorted PTokenName PInteger)
-&gt; Term s (PInner (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData (PMap 'Sorted PTokenName PInteger))
-&gt; Term s (PMap 'Sorted PTokenName PInteger)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><span class="hs-identifier hs-var">psndBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData (PMap 'Sorted PTokenName PInteger))
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
-&gt; Term s (PAsData (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679271870"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>                                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(forall (s1 :: S).
 Term s1 PInteger
 -&gt; Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
 -&gt; Term s1 PInteger)
-&gt; Term
     s
     (PInteger
      :--&gt; (PBuiltinList
              (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
            :--&gt; PInteger))
forall (list :: PType -&gt; PType) (a :: PType) (b :: PType) (s :: S).
PIsListLike list a =&gt;
(forall (s1 :: S). Term s1 b -&gt; Term s1 a -&gt; Term s1 b)
-&gt; Term s (b :--&gt; (list a :--&gt; b))
</span><span class="hs-identifier hs-var">pfoldl'</span></span><span>
</span><span id="line-269"></span><span>                                                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679271876"><span class="annot"><span class="annottext">Term s1 PInteger
</span><a href="#local-6989586621679271876"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679271877"><span class="annot"><span class="annottext">Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
</span><a href="#local-6989586621679271877"><span class="hs-identifier hs-var">tokenAndAmount</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>                                                    </span><span class="annot"><span class="annottext">Term s1 (PAsData PInteger) -&gt; Term s1 PInteger
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s1
  (PBuiltinPair (PAsData PTokenName) (PAsData PInteger)
   :--&gt; PAsData PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><span class="hs-identifier hs-var">psndBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s1
  (PBuiltinPair (PAsData PTokenName) (PAsData PInteger)
   :--&gt; PAsData PInteger)
-&gt; Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
-&gt; Term s1 (PAsData PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
</span><a href="#local-6989586621679271877"><span class="hs-identifier hs-var">tokenAndAmount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s1 PInteger -&gt; Term s1 PInteger -&gt; Term s1 PInteger
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Term s1 PInteger
</span><a href="#local-6989586621679271876"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-271"></span><span>                                                </span><span class="hs-special">)</span><span class="hs-cpp">
                                                # 0
</span><span class="hs-cpp">                                                # tokens
</span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679271868"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679271871"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>                                  </span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>                                  </span><span class="annot"><span class="annottext">Term s PInteger
</span><span class="hs-number">0</span></span><span>
</span><span id="line-278"></span><span>                                  </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679271869"><span class="hs-identifier hs-var">valueMap'</span></a></span><span>
</span><span id="line-279"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679271867"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
Term s (PInner (PInner (PValue 'Sorted 'Positive)))
</span><a href="#local-6989586621679271866"><span class="hs-identifier hs-var">valueMap</span></a></span><span>
</span><span id="line-280"></span><span>                        </span><span class="hs-special">)</span><span class="hs-cpp">
                          #== pconstant 1
</span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>                      </span><span class="annot"><span class="annottext">((PBool s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-284"></span><span>                        </span><span class="hs-comment">-- If it contains exactly one token with the given symbol</span><span>
</span><span id="line-285"></span><span>                        </span><span class="hs-comment">-- then check that it does not contain any other tokens</span><span>
</span><span id="line-286"></span><span>                        </span><span class="hs-comment">-- aside from Ada and the given token</span><span>
</span><span id="line-287"></span><span>                        </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PTrue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PCurrencySymbol))
-&gt; (PBuiltinList (PAsData PCurrencySymbol) s -&gt; Term s PBool)
-&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-288"></span><span>                          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PAsData PCurrencySymbol :--&gt; PBool)
   :--&gt; (PBuiltinList (PAsData PCurrencySymbol)
         :--&gt; PBuiltinList (PAsData PCurrencySymbol)))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><span class="hs-identifier hs-var">pfilter</span></span><span class="hs-cpp">
                              # plam
</span><span>                                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">symbolInValue</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>                                    </span><span class="hs-identifier">pnot</span><span class="hs-cpp">
                                      #$ pfromData symbolInValue
</span><span class="hs-cpp">                                      #== symbol
</span><span class="hs-cpp">                                      #|| pfromData symbolInValue
</span><span class="hs-cpp">                                      #== padaSymbol
</span><span>                                </span><span class="hs-special">)</span><span class="hs-cpp">
                              # (pkeys #$ pto $ pfromData $ pfield @&quot;value&quot; # txOut')
</span><span>                          </span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>                          </span><span class="annot"><span class="annottext">((PBuiltinList (PAsData PCurrencySymbol) s -&gt; Term s PBool)
 -&gt; Term s PBool)
-&gt; (PBuiltinList (PAsData PCurrencySymbol) s -&gt; Term s PBool)
-&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-300"></span><span>                            </span><span class="hs-comment">-- Finally check that it holds a valid output datum</span><span>
</span><span id="line-301"></span><span>                            </span><span class="hs-comment">-- With the length of the yield list not exceeding `maxYieldListSize` parameter</span><span>
</span><span id="line-302"></span><span>                            </span><span class="annot"><span class="annottext">PBuiltinList (PAsData PCurrencySymbol) s
</span><span class="hs-identifier hs-var">PNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>                              </span><span class="annot"><span class="annottext">Term s POutputDatum
-&gt; (POutputDatum s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData POutputDatum) -&gt; Term s POutputDatum
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData POutputDatum) -&gt; Term s POutputDatum)
-&gt; Term s (PAsData POutputDatum) -&gt; Term s POutputDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxOut :--&gt; PAsData POutputDatum)
-&gt; Term s PTxOut -&gt; Term s (PAsData POutputDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PTxOut
</span><a href="#local-6989586621679271863"><span class="hs-identifier hs-var">txOut'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((POutputDatum s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (POutputDatum s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-304"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">POutputDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PDatum) -&gt; Term s PDatum
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PDatum) -&gt; Term s PDatum)
-&gt; (Term
      s
      (PDataRecord
         ((':)
            @PLabeledType (&quot;outputDatum&quot; ':= PDatum) ('[] @PLabeledType)))
    -&gt; Term s (PAsData PDatum))
-&gt; Term
     s
     (PDataRecord
        ((':)
           @PLabeledType (&quot;outputDatum&quot; ':= PDatum) ('[] @PLabeledType)))
-&gt; Term s PDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;outputDatum&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679271882"><span class="annot"><span class="annottext">Term s PDatum
</span><a href="#local-6989586621679271882"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TermCont @PBool s (Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S). TermCont @a s (Term s a) -&gt; Term s a
</span><span class="hs-identifier hs-var">unTermCont</span></span><span> </span><span class="annot"><span class="annottext">(TermCont @PBool s (Term s PBool) -&gt; Term s PBool)
-&gt; TermCont @PBool s (Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>                                  </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html#PYieldListDatum"><span class="hs-identifier hs-type">PYieldListDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;yieldedToScripts&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679271884"><span class="annot"><span class="annottext">Term s (PAsData (PBuiltinList (PAsData PYieldedToHash)))
</span><a href="#local-6989586621679271884"><span class="hs-identifier hs-var">yieldedToList</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-306"></span><span>                                    </span><span class="annot"><span class="annottext">Term s PYieldListDatum -&gt; TermCont @PBool s (PYieldListDatum s)
forall {r :: PType} (a :: PType) (s :: S).
PlutusType a =&gt;
Term s a -&gt; TermCont @r s (a s)
</span><span class="hs-identifier hs-var">pmatchC</span></span><span> </span><span class="annot"><span class="annottext">(Term s PYieldListDatum -&gt; TermCont @PBool s (PYieldListDatum s))
-&gt; Term s PYieldListDatum -&gt; TermCont @PBool s (PYieldListDatum s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PYieldListDatum) -&gt; Term s PYieldListDatum
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PYieldListDatum) -&gt; Term s PYieldListDatum)
-&gt; Term s (PAsData PYieldListDatum) -&gt; Term s PYieldListDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PInner PDatum)
 -&gt; ((Term s (PAsData PYieldListDatum),
      GReduce
        (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)
        (Rep (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)))
     -&gt; Term s (PAsData PYieldListDatum))
 -&gt; Term s (PAsData PYieldListDatum))
-&gt; ((Term s (PAsData PYieldListDatum),
     GReduce
       (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)
       (Rep (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)))
    -&gt; Term s (PAsData PYieldListDatum))
-&gt; Term s (PInner PDatum)
-&gt; Term s (PAsData PYieldListDatum)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInner PDatum)
-&gt; ((Term s (PAsData PYieldListDatum),
     Reduce
       (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s))
    -&gt; Term s (PAsData PYieldListDatum))
-&gt; Term s (PAsData PYieldListDatum)
Term s (PInner PDatum)
-&gt; ((Term s (PAsData PYieldListDatum),
     GReduce
       (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)
       (Rep (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)))
    -&gt; Term s (PAsData PYieldListDatum))
-&gt; Term s (PAsData PYieldListDatum)
forall (b :: PType) (a :: PType) (s :: S) (r :: PType).
PTryFrom a b =&gt;
Term s a
-&gt; ((Term s b, Reduce (PTryFromExcess a b s)) -&gt; Term s r)
-&gt; Term s r
</span><span class="hs-identifier hs-var">ptryFrom</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PYieldListDatum),
 GReduce
   (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)
   (Rep (PTryFromExcess (PInner PDatum) (PAsData PYieldListDatum) s)))
-&gt; Term s (PAsData PYieldListDatum)
forall a b. (a, b) -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s (PInner PDatum) -&gt; Term s (PAsData PYieldListDatum))
-&gt; Term s (PInner PDatum) -&gt; Term s (PAsData PYieldListDatum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatum -&gt; Term s (PInner PDatum)
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="annot"><span class="annottext">Term s PDatum
</span><a href="#local-6989586621679271882"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-307"></span><span>                                  </span><span class="annot"><span class="annottext">Term s PBool -&gt; TermCont @PBool s (Term s PBool)
forall a. a -&gt; TermCont @PBool s a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PBool -&gt; TermCont @PBool s (Term s PBool))
-&gt; Term s PBool -&gt; TermCont @PBool s (Term s PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-308"></span><span>                                    </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PYieldedToHash) :--&gt; PInteger)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s (list a :--&gt; PInteger)
</span><span class="hs-identifier hs-var">plength</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PAsData PYieldedToHash) :--&gt; PInteger)
-&gt; Term s (PBuiltinList (PAsData PYieldedToHash))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PBuiltinList (PAsData PYieldedToHash)))
-&gt; Term s (PBuiltinList (PAsData PYieldedToHash))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData (PBuiltinList (PAsData PYieldedToHash)))
</span><a href="#local-6989586621679271884"><span class="hs-identifier hs-var">yieldedToList</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PInteger -&gt; Term s PInteger -&gt; Term s PBool
forall (s :: S). Term s PInteger -&gt; Term s PInteger -&gt; Term s PBool
forall (t :: PType) (s :: S).
PPartialOrd t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><span class="hs-operator hs-var">#&lt;=</span></span><span> </span><span class="annot"><span class="annottext">PLifted PInteger -&gt; Term s PInteger
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Real.html#toInteger"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621679271846"><span class="hs-identifier hs-var">maxYieldListSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>                                </span><span class="annot"><span class="annottext">POutputDatum s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-310"></span><span>                            </span><span class="annot"><span class="annottext">PBuiltinList (PAsData PCurrencySymbol) s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-311"></span><span>                        </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PFalse</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-312"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">PPubKeyCredential</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PDataRecord
     ((':) @PLabeledType (&quot;_0&quot; ':= PPubKeyHash) ('[] @PLabeledType)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PFalse</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxOut s
</span><span class="hs-identifier hs-var">PNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- Check that there is one input with exactly one token of given `PCurrencySymbol`,</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- this input sits at a script address matching the given `PTxOutRef`,</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- and there are no other script inputs with one or more of the token with the given symbol.</span><span>
</span><span id="line-319"></span><span id="local-6989586621679271339"><span class="annot"><a href="Utils.html#phasOneScriptInputAtValidatorWithExactlyOneToken"><span class="hs-identifier hs-type">phasOneScriptInputAtValidatorWithExactlyOneToken</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PBuiltinList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxInInfo</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxOutRef</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-322"></span><span id="phasOneScriptInputAtValidatorWithExactlyOneToken"><span class="annot"><span class="annottext">phasOneScriptInputAtValidatorWithExactlyOneToken :: forall (s :: S).
Term s (PBuiltinList PTxInInfo)
-&gt; Term s (PCurrencySymbol :--&gt; (PTxOutRef :--&gt; PBool))
</span><a href="Utils.html#phasOneScriptInputAtValidatorWithExactlyOneToken"><span class="hs-identifier hs-var hs-var">phasOneScriptInputAtValidatorWithExactlyOneToken</span></a></span></span><span> </span><span id="local-6989586621679272037"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272037"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol -&gt; Term s PTxOutRef -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; (PTxOutRef :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s PTxOutRef -&gt; Term s PBool)
-&gt; Term s (c :--&gt; (PTxOutRef :--&gt; PBool))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol -&gt; Term s PTxOutRef -&gt; Term s PBool)
 -&gt; Term s (PCurrencySymbol :--&gt; (PTxOutRef :--&gt; PBool)))
-&gt; (Term s PCurrencySymbol -&gt; Term s PTxOutRef -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; (PTxOutRef :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272038"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679272038"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span id="local-6989586621679272039"><span class="annot"><span class="annottext">Term s PTxOutRef
</span><a href="#local-6989586621679272039"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
-&gt; (PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Term
  s
  ((PTxInInfo :--&gt; PBool)
   :--&gt; (PBuiltinList PTxInInfo :--&gt; PBuiltinList PTxInInfo))
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
PIsListLike list a =&gt;
Term s ((a :--&gt; PBool) :--&gt; (list a :--&gt; list a))
</span><span class="hs-identifier hs-var">pfilter</span></span><span class="hs-cpp">
          # plam
</span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">txInInfo</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>                </span><span class="hs-identifier">pmatch</span><span>
</span><span id="line-329"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">pfromData</span><span>
</span><span id="line-330"></span><span>                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;credential&quot;</span><span class="hs-cpp">
                        #$ pfromData
</span><span>                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;address&quot;</span><span class="hs-cpp">
                        #$ pfromData
</span><span>                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span class="hs-cpp">
                        # txInInfo
</span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>                  </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-338"></span><span>                    </span><span class="hs-comment">-- We're only interested in script inputs</span><span>
</span><span id="line-339"></span><span>                    </span><span class="hs-identifier">PScriptCredential</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>                      </span><span class="hs-comment">-- Check the inputs contains one or more YieldListSTT.</span><span>
</span><span id="line-341"></span><span>                      </span><span class="hs-comment">-- At this step, we want to find any input that contains one or more YieldListSTT.</span><span>
</span><span id="line-342"></span><span>                      </span><span class="hs-comment">-- This is to avoid needing another helper to check that there are no other script</span><span>
</span><span id="line-343"></span><span>                      </span><span class="hs-comment">-- inputs containing one or more of these tokens.</span><span>
</span><span id="line-344"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">pconstant</span><span> </span><span class="hs-number">0</span><span class="hs-cpp">
                          #&lt; (
</span><span>                               </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-347"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">valueMap</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>                                    </span><span class="hs-identifier">pto</span><span>
</span><span id="line-349"></span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pto</span><span>
</span><span id="line-350"></span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfromData</span><span>
</span><span id="line-351"></span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;value&quot;</span><span class="hs-cpp">
                                        #$ pfromData
</span><span>                                      </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span class="hs-cpp">
                                        # txInInfo
</span><span>                                   </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pfix</span><span> </span><span class="hs-operator">#$</span><span> </span><span class="hs-identifier">plam</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">self</span><span> </span><span class="hs-identifier">valueMap'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>                                    </span><span class="hs-identifier">pelimList</span><span>
</span><span id="line-357"></span><span>                                      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">symbolAndTokens</span><span> </span><span class="hs-identifier">rest</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>                                          </span><span class="hs-identifier">pif</span><span>
</span><span id="line-359"></span><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfstBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#==</span><span> </span><span class="hs-identifier">symbol</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>                                            </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pto</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">symbolAndTokens</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>                                               </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">pfoldl'</span><span>
</span><span id="line-362"></span><span>                                                    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-363"></span><span>                                                        </span><span class="hs-identifier">pfromData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">psndBuiltin</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">tokenAndAmount</span><span class="hs-special">)</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-364"></span><span>                                                    </span><span class="hs-special">)</span><span class="hs-cpp">
                                                    # 0
</span><span class="hs-cpp">                                                    # tokens
</span><span>                                            </span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>                                            </span><span class="hs-special">(</span><span class="hs-identifier">self</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">rest</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>                                      </span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>                                      </span><span class="hs-number">0</span><span>
</span><span id="line-371"></span><span>                                      </span><span class="hs-identifier">valueMap'</span><span>
</span><span id="line-372"></span><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">valueMap</span><span>
</span><span id="line-373"></span><span>                             </span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>                    </span><span class="hs-identifier">PPubKeyCredential</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pconstant</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-376"></span><span>            </span><span class="hs-special">)</span><span class="hs-cpp">
          # inputs
</span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><span class="annottext">((PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-380"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PCons</span></span><span> </span><span id="local-6989586621679272053"><span class="annot"><span class="annottext">Term s PTxInInfo
</span><a href="#local-6989586621679272053"><span class="hs-identifier hs-var">txInInfo'</span></a></span></span><span> </span><span id="local-6989586621679272054"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272054"><span class="hs-identifier hs-var">tailOfList</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>          </span><span class="hs-comment">-- Check there's exactly one element in the filtered list</span><span>
</span><span id="line-382"></span><span>          </span><span class="annot"><span class="annottext">Term s PBool -&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo :--&gt; PBool)
forall (a :: PType) (s :: S).
PElemConstraint PBuiltinList a =&gt;
Term s (PBuiltinList a :--&gt; PBool)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
(PListLike list, PElemConstraint list a) =&gt;
Term s (list a :--&gt; PBool)
</span><span class="hs-identifier hs-var">pnull</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo :--&gt; PBool)
-&gt; Term s (PBuiltinList PTxInInfo) -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272054"><span class="hs-identifier hs-var">tailOfList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PBool s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PTrue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-384"></span><span>              </span><span class="hs-comment">-- Check that the given ref and the ref of this input match</span><span>
</span><span id="line-385"></span><span>              </span><span class="annot"><span class="annottext">Term s PBool -&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s PTxOutRef
</span><a href="#local-6989586621679272039"><span class="hs-identifier hs-var">txOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PTxOutRef -&gt; Term s PTxOutRef -&gt; Term s PBool
forall (s :: S).
Term s PTxOutRef -&gt; Term s PTxOutRef -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><span class="hs-operator hs-var">#==</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxOutRef) -&gt; Term s PTxOutRef
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;outRef&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxInInfo :--&gt; PAsData PTxOutRef)
-&gt; Term s PTxInInfo -&gt; Term s (PAsData PTxOutRef)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PTxInInfo
</span><a href="#local-6989586621679272053"><span class="hs-identifier hs-var">txInInfo'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PBool s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-386"></span><span>                </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PTrue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>                  </span><span class="hs-comment">-- Check that the input contains exactly one token with the given symbol</span><span>
</span><span id="line-388"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-389"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679272055"><span class="annot"><span class="annottext">valueMap :: Term
  s
  (PInner
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut)))))
</span><a href="#local-6989586621679272055"><span class="hs-identifier hs-var hs-var">valueMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>                            </span><span class="annot"><span class="annottext">Term
  s
  (PInner
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut))))
-&gt; Term
     s
     (PInner
        (PInner
           (PUnLabel
              (IndexList
                 @PLabeledType
                 (PLabelIndex &quot;value&quot; (PFields PTxOut))
                 (PFields PTxOut)))))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span>
</span><span id="line-391"></span><span>                              </span><span class="annot"><span class="annottext">(Term
   s
   (PInner
      (PUnLabel
         (IndexList
            @PLabeledType
            (PLabelIndex &quot;value&quot; (PFields PTxOut))
            (PFields PTxOut))))
 -&gt; Term
      s
      (PInner
         (PInner
            (PUnLabel
               (IndexList
                  @PLabeledType
                  (PLabelIndex &quot;value&quot; (PFields PTxOut))
                  (PFields PTxOut))))))
-&gt; Term
     s
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
-&gt; Term
     s
     (PInner
        (PInner
           (PUnLabel
              (IndexList
                 @PLabeledType
                 (PLabelIndex &quot;value&quot; (PFields PTxOut))
                 (PFields PTxOut)))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PUnLabel
     (IndexList
        @PLabeledType
        (PLabelIndex &quot;value&quot; (PFields PTxOut))
        (PFields PTxOut)))
-&gt; Term
     s
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span>
</span><span id="line-392"></span><span>                              </span><span class="annot"><span class="annottext">(Term
   s
   (PUnLabel
      (IndexList
         @PLabeledType
         (PLabelIndex &quot;value&quot; (PFields PTxOut))
         (PFields PTxOut)))
 -&gt; Term
      s
      (PInner
         (PUnLabel
            (IndexList
               @PLabeledType
               (PLabelIndex &quot;value&quot; (PFields PTxOut))
               (PFields PTxOut)))))
-&gt; Term
     s
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut)))
-&gt; Term
     s
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut))))
-&gt; Term
     s
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut)))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span>
</span><span id="line-393"></span><span>                              </span><span class="annot"><span class="annottext">(Term
   s
   (PAsData
      (PUnLabel
         (IndexList
            @PLabeledType
            (PLabelIndex &quot;value&quot; (PFields PTxOut))
            (PFields PTxOut))))
 -&gt; Term
      s
      (PUnLabel
         (IndexList
            @PLabeledType
            (PLabelIndex &quot;value&quot; (PFields PTxOut))
            (PFields PTxOut))))
-&gt; Term
     s
     (PAsData
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
-&gt; Term
     s
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span class="hs-cpp">
                                #$ pfromData
</span><span>                              </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span class="hs-cpp">
                                # txInInfo'
</span><span>                          </span><span id="local-6989586621679272056"><span class="annot"><span class="annottext">go :: Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272056"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (((PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
    :--&gt; (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger)))
          :--&gt; PInteger))
   :--&gt; (PBuiltinList
           (PBuiltinPair
              (PAsData PCurrencySymbol)
              (PAsData (PMap 'Sorted PTokenName PInteger)))
         :--&gt; PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (((a :--&gt; b) :--&gt; (a :--&gt; b)) :--&gt; (a :--&gt; b))
</span><span class="hs-identifier hs-var">pfix</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (((PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
    :--&gt; (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger)))
          :--&gt; PInteger))
   :--&gt; (PBuiltinList
           (PBuiltinPair
              (PAsData PCurrencySymbol)
              (PAsData (PMap 'Sorted PTokenName PInteger)))
         :--&gt; PInteger))
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger)))
      :--&gt; PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#$</span></span><span> </span><span class="annot"><span class="annottext">(Term
   s
   (PBuiltinList
      (PBuiltinPair
         (PAsData PCurrencySymbol)
         (PAsData (PMap 'Sorted PTokenName PInteger)))
    :--&gt; PInteger)
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term
     s
     (c
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term
    s
    (PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
  -&gt; Term
       s
       (PBuiltinList
          (PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap 'Sorted PTokenName PInteger))))
  -&gt; Term s PInteger)
 -&gt; Term
      s
      ((PBuiltinList
          (PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap 'Sorted PTokenName PInteger)))
        :--&gt; PInteger)
       :--&gt; (PBuiltinList
               (PBuiltinPair
                  (PAsData PCurrencySymbol)
                  (PAsData (PMap 'Sorted PTokenName PInteger)))
             :--&gt; PInteger)))
-&gt; (Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
    -&gt; Term
         s
         (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger))))
    -&gt; Term s PInteger)
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272057"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272057"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679272058"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272058"><span class="hs-identifier hs-var">valueMap'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-398"></span><span>                            </span><span class="annot"><span class="annottext">(Term
   s
   (PBuiltinPair
      (PAsData PCurrencySymbol)
      (PAsData (PMap 'Sorted PTokenName PInteger)))
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term s PInteger
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (a :: PType) (s :: S) (r :: PType).
PElemConstraint PBuiltinList a =&gt;
(Term s a -&gt; Term s (PBuiltinList a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (PBuiltinList a) -&gt; Term s r
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
(PListLike list, PElemConstraint list a) =&gt;
(Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (list a) -&gt; Term s r
</span><span class="hs-identifier hs-var">pelimList</span></span><span>
</span><span id="line-399"></span><span>                              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272059"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272059"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span></span><span> </span><span id="local-6989586621679272060"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272060"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>                                  </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s PInteger -&gt; Term s PInteger -&gt; Term s PInteger
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><span class="hs-identifier hs-var">pif</span></span><span>
</span><span id="line-401"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PCurrencySymbol) -&gt; Term s PCurrencySymbol
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData PCurrencySymbol)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; a)
</span><span class="hs-identifier hs-var">pfstBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData PCurrencySymbol)
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
-&gt; Term s (PAsData PCurrencySymbol)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272059"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol -&gt; Term s PCurrencySymbol -&gt; Term s PBool
forall (s :: S).
Term s PCurrencySymbol -&gt; Term s PCurrencySymbol -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><span class="hs-operator hs-var">#==</span></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679272038"><span class="hs-identifier hs-var">symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>                                    </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679272061"><span class="annot"><span class="annottext">tokens :: Term s (PInner (PInner (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272061"><span class="hs-identifier hs-var hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PInner (PMap 'Sorted PTokenName PInteger))
-&gt; Term s (PInner (PInner (PMap 'Sorted PTokenName PInteger)))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PMap 'Sorted PTokenName PInteger)
-&gt; Term s (PInner (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData (PMap 'Sorted PTokenName PInteger))
-&gt; Term s (PMap 'Sorted PTokenName PInteger)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><span class="hs-identifier hs-var">psndBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData (PMap 'Sorted PTokenName PInteger))
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
-&gt; Term s (PAsData (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272059"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(forall (s1 :: S).
 Term s1 PInteger
 -&gt; Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
 -&gt; Term s1 PInteger)
-&gt; Term
     s
     (PInteger
      :--&gt; (PBuiltinList
              (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
            :--&gt; PInteger))
forall (list :: PType -&gt; PType) (a :: PType) (b :: PType) (s :: S).
PIsListLike list a =&gt;
(forall (s1 :: S). Term s1 b -&gt; Term s1 a -&gt; Term s1 b)
-&gt; Term s (b :--&gt; (list a :--&gt; b))
</span><span class="hs-identifier hs-var">pfoldl'</span></span><span>
</span><span id="line-404"></span><span>                                            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272065"><span class="annot"><span class="annottext">Term s1 PInteger
</span><a href="#local-6989586621679272065"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679272066"><span class="annot"><span class="annottext">Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
</span><a href="#local-6989586621679272066"><span class="hs-identifier hs-var">tokenAndAmount</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>                                                </span><span class="annot"><span class="annottext">Term s1 (PAsData PInteger) -&gt; Term s1 PInteger
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s1
  (PBuiltinPair (PAsData PTokenName) (PAsData PInteger)
   :--&gt; PAsData PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><span class="hs-identifier hs-var">psndBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s1
  (PBuiltinPair (PAsData PTokenName) (PAsData PInteger)
   :--&gt; PAsData PInteger)
-&gt; Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
-&gt; Term s1 (PAsData PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
</span><a href="#local-6989586621679272066"><span class="hs-identifier hs-var">tokenAndAmount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s1 PInteger -&gt; Term s1 PInteger -&gt; Term s1 PInteger
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Term s1 PInteger
</span><a href="#local-6989586621679272065"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-406"></span><span>                                            </span><span class="hs-special">)</span><span class="hs-cpp">
                                            # 0
</span><span class="hs-cpp">                                            # tokens
</span><span>                                    </span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272057"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272060"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                              </span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                              </span><span class="annot"><span class="annottext">Term s PInteger
</span><span class="hs-number">0</span></span><span>
</span><span id="line-413"></span><span>                              </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272058"><span class="hs-identifier hs-var">valueMap'</span></a></span><span>
</span><span id="line-414"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
Term
  s
  (PInner
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut)))))
</span><a href="#local-6989586621679272055"><span class="hs-identifier hs-var">valueMap</span></a></span><span>
</span><span id="line-415"></span><span>                    </span><span class="hs-special">)</span><span class="hs-cpp">
                      #== pconstant 1
</span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>                </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PFalse</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-419"></span><span>            </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PFalse</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxInInfo s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">{- | Check that there is exactly one input,
and that one input carries exactly one yield list token.
-}</span></span><span>
</span><span id="line-425"></span><span id="local-6989586621679272067"><span class="annot"><a href="Utils.html#phasOnlyOneInputWithExactlyOneTokenWithSymbol"><span class="hs-identifier hs-type">phasOnlyOneInputWithExactlyOneTokenWithSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679272067"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PBuiltinList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxInInfo</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679272067"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-428"></span><span id="phasOnlyOneInputWithExactlyOneTokenWithSymbol"><span class="annot"><span class="annottext">phasOnlyOneInputWithExactlyOneTokenWithSymbol :: forall (s :: S).
Term s (PBuiltinList PTxInInfo)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
</span><a href="Utils.html#phasOnlyOneInputWithExactlyOneTokenWithSymbol"><span class="hs-identifier hs-var hs-var">phasOnlyOneInputWithExactlyOneTokenWithSymbol</span></a></span></span><span> </span><span id="local-6989586621679272124"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272124"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><span class="annottext">(Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s PBool) -&gt; Term s (c :--&gt; PBool)
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s PCurrencySymbol -&gt; Term s PBool)
 -&gt; Term s (PCurrencySymbol :--&gt; PBool))
-&gt; (Term s PCurrencySymbol -&gt; Term s PBool)
-&gt; Term s (PCurrencySymbol :--&gt; PBool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272125"><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679272125"><span class="hs-identifier hs-var">symbol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
-&gt; (PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272124"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="annot"><span class="annottext">((PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBuiltinList PTxInInfo s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PCons</span></span><span> </span><span id="local-6989586621679272126"><span class="annot"><span class="annottext">Term s PTxInInfo
</span><a href="#local-6989586621679272126"><span class="hs-identifier hs-var">txInInfo</span></a></span></span><span> </span><span id="local-6989586621679272127"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272127"><span class="hs-identifier hs-var">tailOfList</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-433"></span><span>          </span><span class="annot"><span class="annottext">Term s PBool -&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo :--&gt; PBool)
forall (a :: PType) (s :: S).
PElemConstraint PBuiltinList a =&gt;
Term s (PBuiltinList a :--&gt; PBool)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S).
(PListLike list, PElemConstraint list a) =&gt;
Term s (list a :--&gt; PBool)
</span><span class="hs-identifier hs-var">pnull</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo :--&gt; PBool)
-&gt; Term s (PBuiltinList PTxInInfo) -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679272127"><span class="hs-identifier hs-var">tailOfList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PBool s -&gt; Term s PBool) -&gt; Term s PBool)
-&gt; (PBool s -&gt; Term s PBool) -&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier hs-var">PTrue</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- We inline the `psymbolValue` function for efficiency reasons</span><span>
</span><span id="line-436"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679272128"><span class="annot"><span class="annottext">valueMap :: Term
  s
  (PInner
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut)))))
</span><a href="#local-6989586621679272128"><span class="hs-identifier hs-var hs-var">valueMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>                        </span><span class="annot"><span class="annottext">Term
  s
  (PInner
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut))))
-&gt; Term
     s
     (PInner
        (PInner
           (PUnLabel
              (IndexList
                 @PLabeledType
                 (PLabelIndex &quot;value&quot; (PFields PTxOut))
                 (PFields PTxOut)))))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span>
</span><span id="line-438"></span><span>                          </span><span class="annot"><span class="annottext">(Term
   s
   (PInner
      (PUnLabel
         (IndexList
            @PLabeledType
            (PLabelIndex &quot;value&quot; (PFields PTxOut))
            (PFields PTxOut))))
 -&gt; Term
      s
      (PInner
         (PInner
            (PUnLabel
               (IndexList
                  @PLabeledType
                  (PLabelIndex &quot;value&quot; (PFields PTxOut))
                  (PFields PTxOut))))))
-&gt; Term
     s
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
-&gt; Term
     s
     (PInner
        (PInner
           (PUnLabel
              (IndexList
                 @PLabeledType
                 (PLabelIndex &quot;value&quot; (PFields PTxOut))
                 (PFields PTxOut)))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PUnLabel
     (IndexList
        @PLabeledType
        (PLabelIndex &quot;value&quot; (PFields PTxOut))
        (PFields PTxOut)))
-&gt; Term
     s
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span>
</span><span id="line-439"></span><span>                          </span><span class="annot"><span class="annottext">(Term
   s
   (PUnLabel
      (IndexList
         @PLabeledType
         (PLabelIndex &quot;value&quot; (PFields PTxOut))
         (PFields PTxOut)))
 -&gt; Term
      s
      (PInner
         (PUnLabel
            (IndexList
               @PLabeledType
               (PLabelIndex &quot;value&quot; (PFields PTxOut))
               (PFields PTxOut)))))
-&gt; Term
     s
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut)))
-&gt; Term
     s
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PAsData
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut))))
-&gt; Term
     s
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut)))
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span>
</span><span id="line-440"></span><span>                          </span><span class="annot"><span class="annottext">(Term
   s
   (PAsData
      (PUnLabel
         (IndexList
            @PLabeledType
            (PLabelIndex &quot;value&quot; (PFields PTxOut))
            (PFields PTxOut))))
 -&gt; Term
      s
      (PUnLabel
         (IndexList
            @PLabeledType
            (PLabelIndex &quot;value&quot; (PFields PTxOut))
            (PFields PTxOut))))
-&gt; Term
     s
     (PAsData
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut))))
-&gt; Term
     s
     (PUnLabel
        (IndexList
           @PLabeledType
           (PLabelIndex &quot;value&quot; (PFields PTxOut))
           (PFields PTxOut)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span class="hs-cpp">
                            #$ pfromData
</span><span>                          </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pfield</span><span> </span><span class="hs-glyph">@</span><span class="hs-string">&quot;resolved&quot;</span><span class="hs-cpp">
                            # txInInfo
</span><span>                      </span><span id="local-6989586621679272129"><span class="annot"><span class="annottext">go :: Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272129"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (((PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
    :--&gt; (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger)))
          :--&gt; PInteger))
   :--&gt; (PBuiltinList
           (PBuiltinPair
              (PAsData PCurrencySymbol)
              (PAsData (PMap 'Sorted PTokenName PInteger)))
         :--&gt; PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (((a :--&gt; b) :--&gt; (a :--&gt; b)) :--&gt; (a :--&gt; b))
</span><span class="hs-identifier hs-var">pfix</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (((PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
    :--&gt; (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger)))
          :--&gt; PInteger))
   :--&gt; (PBuiltinList
           (PBuiltinPair
              (PAsData PCurrencySymbol)
              (PAsData (PMap 'Sorted PTokenName PInteger)))
         :--&gt; PInteger))
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger)))
      :--&gt; PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#$</span></span><span> </span><span class="annot"><span class="annottext">(Term
   s
   (PBuiltinList
      (PBuiltinPair
         (PAsData PCurrencySymbol)
         (PAsData (PMap 'Sorted PTokenName PInteger)))
    :--&gt; PInteger)
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term
     s
     (c
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term
    s
    (PBuiltinList
       (PBuiltinPair
          (PAsData PCurrencySymbol)
          (PAsData (PMap 'Sorted PTokenName PInteger)))
     :--&gt; PInteger)
  -&gt; Term
       s
       (PBuiltinList
          (PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap 'Sorted PTokenName PInteger))))
  -&gt; Term s PInteger)
 -&gt; Term
      s
      ((PBuiltinList
          (PBuiltinPair
             (PAsData PCurrencySymbol)
             (PAsData (PMap 'Sorted PTokenName PInteger)))
        :--&gt; PInteger)
       :--&gt; (PBuiltinList
               (PBuiltinPair
                  (PAsData PCurrencySymbol)
                  (PAsData (PMap 'Sorted PTokenName PInteger)))
             :--&gt; PInteger)))
-&gt; (Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
    -&gt; Term
         s
         (PBuiltinList
            (PBuiltinPair
               (PAsData PCurrencySymbol)
               (PAsData (PMap 'Sorted PTokenName PInteger))))
    -&gt; Term s PInteger)
-&gt; Term
     s
     ((PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger)))
       :--&gt; PInteger)
      :--&gt; (PBuiltinList
              (PBuiltinPair
                 (PAsData PCurrencySymbol)
                 (PAsData (PMap 'Sorted PTokenName PInteger)))
            :--&gt; PInteger))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272130"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272130"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679272131"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272131"><span class="hs-identifier hs-var">valueMap'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-445"></span><span>                        </span><span class="annot"><span class="annottext">(Term
   s
   (PBuiltinPair
      (PAsData PCurrencySymbol)
      (PAsData (PMap 'Sorted PTokenName PInteger)))
 -&gt; Term
      s
      (PBuiltinList
         (PBuiltinPair
            (PAsData PCurrencySymbol)
            (PAsData (PMap 'Sorted PTokenName PInteger))))
 -&gt; Term s PInteger)
-&gt; Term s PInteger
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (a :: PType) (s :: S) (r :: PType).
PElemConstraint PBuiltinList a =&gt;
(Term s a -&gt; Term s (PBuiltinList a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (PBuiltinList a) -&gt; Term s r
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
(PListLike list, PElemConstraint list a) =&gt;
(Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; Term s r -&gt; Term s (list a) -&gt; Term s r
</span><span class="hs-identifier hs-var">pelimList</span></span><span>
</span><span id="line-446"></span><span>                          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272132"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272132"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span></span><span> </span><span id="local-6989586621679272133"><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272133"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-447"></span><span>                              </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s PInteger -&gt; Term s PInteger -&gt; Term s PInteger
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><span class="hs-identifier hs-var">pif</span></span><span>
</span><span id="line-448"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PCurrencySymbol) -&gt; Term s PCurrencySymbol
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData PCurrencySymbol)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; a)
</span><span class="hs-identifier hs-var">pfstBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData PCurrencySymbol)
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
-&gt; Term s (PAsData PCurrencySymbol)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272132"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol -&gt; Term s PCurrencySymbol -&gt; Term s PBool
forall (s :: S).
Term s PCurrencySymbol -&gt; Term s PCurrencySymbol -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><span class="hs-operator hs-var">#==</span></span><span> </span><span class="annot"><span class="annottext">Term s PCurrencySymbol
</span><a href="#local-6989586621679272125"><span class="hs-identifier hs-var">symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>                                </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679272134"><span class="annot"><span class="annottext">tokens :: Term s (PInner (PInner (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272134"><span class="hs-identifier hs-var hs-var">tokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PInner (PMap 'Sorted PTokenName PInteger))
-&gt; Term s (PInner (PInner (PMap 'Sorted PTokenName PInteger)))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PMap 'Sorted PTokenName PInteger)
-&gt; Term s (PInner (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData (PMap 'Sorted PTokenName PInteger))
-&gt; Term s (PMap 'Sorted PTokenName PInteger)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><span class="hs-identifier hs-var">psndBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger))
   :--&gt; PAsData (PMap 'Sorted PTokenName PInteger))
-&gt; Term
     s
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
-&gt; Term s (PAsData (PMap 'Sorted PTokenName PInteger))
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinPair
     (PAsData PCurrencySymbol)
     (PAsData (PMap 'Sorted PTokenName PInteger)))
</span><a href="#local-6989586621679272132"><span class="hs-identifier hs-var">symbolAndTokens</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(forall (s1 :: S).
 Term s1 PInteger
 -&gt; Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
 -&gt; Term s1 PInteger)
-&gt; Term
     s
     (PInteger
      :--&gt; (PBuiltinList
              (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
            :--&gt; PInteger))
forall (list :: PType -&gt; PType) (a :: PType) (b :: PType) (s :: S).
PIsListLike list a =&gt;
(forall (s1 :: S). Term s1 b -&gt; Term s1 a -&gt; Term s1 b)
-&gt; Term s (b :--&gt; (list a :--&gt; b))
</span><span class="hs-identifier hs-var">pfoldl'</span></span><span>
</span><span id="line-451"></span><span>                                        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272138"><span class="annot"><span class="annottext">Term s1 PInteger
</span><a href="#local-6989586621679272138"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679272139"><span class="annot"><span class="annottext">Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
</span><a href="#local-6989586621679272139"><span class="hs-identifier hs-var">tokenAndAmount</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-452"></span><span>                                            </span><span class="annot"><span class="annottext">Term s1 (PAsData PInteger) -&gt; Term s1 PInteger
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s1
  (PBuiltinPair (PAsData PTokenName) (PAsData PInteger)
   :--&gt; PAsData PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; b)
</span><span class="hs-identifier hs-var">psndBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term
  s1
  (PBuiltinPair (PAsData PTokenName) (PAsData PInteger)
   :--&gt; PAsData PInteger)
-&gt; Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
-&gt; Term s1 (PAsData PInteger)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s1 (PBuiltinPair (PAsData PTokenName) (PAsData PInteger))
</span><a href="#local-6989586621679272139"><span class="hs-identifier hs-var">tokenAndAmount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term s1 PInteger -&gt; Term s1 PInteger -&gt; Term s1 PInteger
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Term s1 PInteger
</span><a href="#local-6989586621679272138"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-453"></span><span>                                        </span><span class="hs-special">)</span><span class="hs-cpp">
                                        # 0
</span><span class="hs-cpp">                                        # tokens
</span><span>                                </span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272130"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272133"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                          </span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>                          </span><span class="annot"><span class="annottext">Term s PInteger
</span><span class="hs-number">0</span></span><span>
</span><span id="line-460"></span><span>                          </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
</span><a href="#local-6989586621679272131"><span class="hs-identifier hs-var">valueMap'</span></a></span><span>
</span><span id="line-461"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
</span><a href="#local-6989586621679272129"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger)))
   :--&gt; PInteger)
-&gt; Term
     s
     (PBuiltinList
        (PBuiltinPair
           (PAsData PCurrencySymbol)
           (PAsData (PMap 'Sorted PTokenName PInteger))))
-&gt; Term s PInteger
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term
  s
  (PBuiltinList
     (PBuiltinPair
        (PAsData PCurrencySymbol)
        (PAsData (PMap 'Sorted PTokenName PInteger))))
Term
  s
  (PInner
     (PInner
        (PUnLabel
           (IndexList
              @PLabeledType
              (PLabelIndex &quot;value&quot; (PFields PTxOut))
              (PFields PTxOut)))))
</span><a href="#local-6989586621679272128"><span class="hs-identifier hs-var">valueMap</span></a></span><span>
</span><span id="line-462"></span><span>                </span><span class="hs-special">)</span><span class="hs-cpp">
                  #== pconstant 1
</span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>            </span><span class="annot"><span class="annottext">PBool s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span class="annot"><span class="annottext">PBuiltinList PTxInInfo s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="annot"><span class="hs-comment">-- | Empty token name</span></span><span>
</span><span id="line-469"></span><span id="local-6989586621679271345"><span class="annot"><a href="Utils.html#pemptyTokenName"><span class="hs-identifier hs-type">pemptyTokenName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271345"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTokenName</span></span></span><span>
</span><span id="line-470"></span><span id="pemptyTokenName"><span class="annot"><span class="annottext">pemptyTokenName :: forall (s :: S). Term s PTokenName
</span><a href="Utils.html#pemptyTokenName"><span class="hs-identifier hs-var hs-var">pemptyTokenName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PLifted PTokenName -&gt; Term s PTokenName
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">PLifted PTokenName
TokenName
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="annot"><span class="hs-comment">-- | Convert a `ScriptHash` to a `CurrencySymbol`, which has the same representation</span></span><span>
</span><span id="line-473"></span><span id="local-6989586621679271348"><span class="annot"><a href="Utils.html#pscriptHashToCurrencySymbol"><span class="hs-identifier hs-type">pscriptHashToCurrencySymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271348"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PScriptHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271348"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PCurrencySymbol</span></span></span><span>
</span><span id="line-474"></span><span id="pscriptHashToCurrencySymbol"><span class="annot"><span class="annottext">pscriptHashToCurrencySymbol :: forall (s :: S). Term s PScriptHash -&gt; Term s PCurrencySymbol
</span><a href="Utils.html#pscriptHashToCurrencySymbol"><span class="hs-identifier hs-var hs-var">pscriptHashToCurrencySymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s PScriptHash -&gt; Term s PCurrencySymbol
forall (s :: S) (a :: PType) (b :: PType). Term s a -&gt; Term s b
</span><span class="hs-identifier hs-var">punsafeCoerce</span></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="annot"><span class="hs-comment">-- | Extract the datum from a 'POutputDatum', expecting it to be an inline datum.</span></span><span>
</span><span id="line-477"></span><span class="annot"><a href="Utils.html#punsafeFromInlineDatum"><span class="hs-identifier hs-type">punsafeFromInlineDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679271353"><span class="annot"><a href="#local-6989586621679271353"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679271354"><span class="annot"><a href="#local-6989586621679271354"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><a href="#local-6989586621679271353"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">POutputDatum</span></span><span>
</span><span id="line-482"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679271354"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span id="punsafeFromInlineDatum"><span class="annot"><span class="annottext">punsafeFromInlineDatum :: forall (s :: S) (a :: PType). Term s (POutputDatum :--&gt; a)
</span><a href="Utils.html#punsafeFromInlineDatum"><span class="hs-identifier hs-var hs-var">punsafeFromInlineDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (POutputDatum :--&gt; a) -&gt; Term s (POutputDatum :--&gt; a)
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><span class="hs-identifier hs-var">phoistAcyclic</span></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (POutputDatum :--&gt; a) -&gt; Term s (POutputDatum :--&gt; a))
-&gt; ClosedTerm (POutputDatum :--&gt; a) -&gt; Term s (POutputDatum :--&gt; a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="annottext">(Term s POutputDatum -&gt; Term s a) -&gt; Term s (POutputDatum :--&gt; a)
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s a) -&gt; Term s (c :--&gt; a)
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s POutputDatum -&gt; Term s a) -&gt; Term s (POutputDatum :--&gt; a))
-&gt; (Term s POutputDatum -&gt; Term s a)
-&gt; Term s (POutputDatum :--&gt; a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272164"><span class="annot"><span class="annottext">Term s POutputDatum
</span><a href="#local-6989586621679272164"><span class="hs-identifier hs-var">od</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s POutputDatum -&gt; (POutputDatum s -&gt; Term s a) -&gt; Term s a
forall (a :: PType) (s :: S) (b :: PType).
PlutusType a =&gt;
Term s a -&gt; (a s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var">pmatch</span></span><span> </span><span class="annot"><span class="annottext">Term s POutputDatum
</span><a href="#local-6989586621679272164"><span class="hs-identifier hs-var">od</span></a></span><span> </span><span class="annot"><span class="annottext">((POutputDatum s -&gt; Term s a) -&gt; Term s a)
-&gt; (POutputDatum s -&gt; Term s a) -&gt; Term s a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">POutputDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PAsData PDatum) -&gt; Term s PDatum
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PDatum) -&gt; Term s PDatum)
-&gt; (Term
      s
      (PDataRecord
         ((':)
            @PLabeledType (&quot;outputDatum&quot; ':= PDatum) ('[] @PLabeledType)))
    -&gt; Term s (PAsData PDatum))
-&gt; Term
     s
     (PDataRecord
        ((':)
           @PLabeledType (&quot;outputDatum&quot; ':= PDatum) ('[] @PLabeledType)))
-&gt; Term s PDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;outputDatum&quot;</span></span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679272165"><span class="annot"><span class="annottext">Term s PDatum
</span><a href="#local-6989586621679272165"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-comment">-- FIXME: Not sure if using `punsafeCoerce` is the best call here</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">Term s PString -&gt; Term s a -&gt; Term s a
forall (s :: S) (a :: PType).
Term s PString -&gt; Term s a -&gt; Term s a
</span><span class="hs-identifier hs-var">ptrace</span></span><span> </span><span class="annot"><span class="annottext">Term s PString
</span><span class="hs-string">&quot;inline datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Term s a -&gt; Term s a) -&gt; Term s a -&gt; Term s a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInner PDatum) -&gt; Term s a
forall (s :: S) (a :: PType) (b :: PType). Term s a -&gt; Term s b
</span><span class="hs-identifier hs-var">punsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PInner PDatum) -&gt; Term s a)
-&gt; Term s (PInner PDatum) -&gt; Term s a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Term s PDatum -&gt; Term s (PInner PDatum)
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="annot"><span class="annottext">Term s PDatum
</span><a href="#local-6989586621679272165"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><span class="annottext">POutputDatum s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term s PString -&gt; Term s a
forall (s :: S) (a :: PType). Term s PString -&gt; Term s a
</span><span class="hs-identifier hs-var">ptraceError</span></span><span> </span><span class="annot"><span class="annottext">Term s PString
</span><span class="hs-string">&quot;Invalid datum type, inline datum expected&quot;</span></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- TODO (OPTIMIZE): this can be turned into partial `phasMember` and `placksMember` variants</span><span>
</span><span id="line-492"></span><span id="local-6989586621679271364"><span id="local-6989586621679271365"><span id="local-6989586621679271366"><span id="local-6989586621679271367"><span class="annot"><a href="Utils.html#pmember"><span class="hs-identifier hs-type">pmember</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PIsData</span></span><span> </span><span class="annot"><a href="#local-6989586621679271364"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679271365"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679271364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679271366"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679271364"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679271367"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBool</span></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-493"></span><span id="pmember"><span class="annot"><span class="annottext">pmember :: forall (k :: PType) (s :: S) (any :: KeyGuarantees) (v :: PType).
PIsData k =&gt;
Term s (k :--&gt; (PMap any k v :--&gt; PBool))
</span><a href="Utils.html#pmember"><span class="hs-identifier hs-var hs-var">pmember</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (k :--&gt; (PMap any k v :--&gt; PBool))
-&gt; Term s (k :--&gt; (PMap any k v :--&gt; PBool))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><span class="hs-identifier hs-var">phoistAcyclic</span></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm (k :--&gt; (PMap any k v :--&gt; PBool))
 -&gt; Term s (k :--&gt; (PMap any k v :--&gt; PBool)))
-&gt; ClosedTerm (k :--&gt; (PMap any k v :--&gt; PBool))
-&gt; Term s (k :--&gt; (PMap any k v :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="annottext">(Term s k -&gt; Term s (PMap any k v) -&gt; Term s PBool)
-&gt; Term s (k :--&gt; (PMap any k v :--&gt; PBool))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s (PMap any k v) -&gt; Term s PBool)
-&gt; Term s (c :--&gt; (PMap any k v :--&gt; PBool))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s k -&gt; Term s (PMap any k v) -&gt; Term s PBool)
 -&gt; Term s (k :--&gt; (PMap any k v :--&gt; PBool)))
-&gt; (Term s k -&gt; Term s (PMap any k v) -&gt; Term s PBool)
-&gt; Term s (k :--&gt; (PMap any k v :--&gt; PBool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272188"><span class="annot"><span class="annottext">Term s k
</span><a href="#local-6989586621679272188"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679272189"><span class="annot"><span class="annottext">Term s (PMap any k v)
</span><a href="#local-6989586621679272189"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-495"></span><span>    </span><span class="annot"><span class="annottext">(Term
   s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
 -&gt; Term s (PBuiltinPair (PAsData k) (PAsData v))
 -&gt; Term s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)))
 -&gt; Term s PBool)
-&gt; (Term
      s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
    -&gt; Term s PBool)
-&gt; Term
     s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
forall (list :: PType -&gt; PType) (a :: PType) (s :: S) (r :: PType).
PIsListLike list a =&gt;
(Term s (list a :--&gt; r) -&gt; Term s a -&gt; Term s (list a) -&gt; Term s r)
-&gt; (Term s (list a :--&gt; r) -&gt; Term s r) -&gt; Term s (list a :--&gt; r)
</span><span class="hs-identifier hs-var">precList</span></span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679272191"><span class="annot"><span class="annottext">Term
  s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
</span><a href="#local-6989586621679272191"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621679272192"><span class="annot"><span class="annottext">Term s (PBuiltinPair (PAsData k) (PAsData v))
</span><a href="#local-6989586621679272192"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679272193"><span class="annot"><span class="annottext">Term s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)))
</span><a href="#local-6989586621679272193"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-497"></span><span>          </span><span class="annot"><span class="annottext">Term s PBool -&gt; Term s PBool -&gt; Term s PBool -&gt; Term s PBool
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><span class="hs-identifier hs-var">pif</span></span><span>
</span><span id="line-498"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (PBuiltinPair (PAsData k) (PAsData v) :--&gt; PAsData k)
forall (s :: S) (a :: PType) (b :: PType).
Term s (PBuiltinPair a b :--&gt; a)
</span><span class="hs-identifier hs-var">pfstBuiltin</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair (PAsData k) (PAsData v) :--&gt; PAsData k)
-&gt; Term s (PBuiltinPair (PAsData k) (PAsData v))
-&gt; Term s (PAsData k)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinPair (PAsData k) (PAsData v))
</span><a href="#local-6989586621679272192"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData k) -&gt; Term s (PAsData k) -&gt; Term s PBool
forall (s :: S).
Term s (PAsData k) -&gt; Term s (PAsData k) -&gt; Term s PBool
forall (t :: PType) (s :: S).
PEq t =&gt;
Term s t -&gt; Term s t -&gt; Term s PBool
</span><span class="hs-operator hs-var">#==</span></span><span> </span><span class="annot"><span class="annottext">Term s k -&gt; Term s (PAsData k)
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s a -&gt; Term s (PAsData a)
</span><span class="hs-identifier hs-var">pdata</span></span><span> </span><span class="annot"><span class="annottext">Term s k
</span><a href="#local-6989586621679272188"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
  s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
</span><a href="#local-6989586621679272191"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
  s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
-&gt; Term s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)))
-&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)))
</span><a href="#local-6989586621679272193"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term
     s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
-&gt; Term s PBool
forall a b. a -&gt; b -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PBool
 -&gt; Term
      s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
 -&gt; Term s PBool)
-&gt; Term s PBool
-&gt; Term
     s (PBuiltinList (PBuiltinPair (PAsData k) (PAsData v)) :--&gt; PBool)
-&gt; Term s PBool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PLifted PBool -&gt; Term s PBool
forall (p :: PType) (s :: S). PLift p =&gt; PLifted p -&gt; Term s p
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">Bool
PLifted PBool
</span><a href="../../../ghc-9.6.5/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
      # pto m
</span></pre></body></html>