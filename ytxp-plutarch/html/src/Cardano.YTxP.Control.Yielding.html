<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-top-binds #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.YTxP.Control.Yielding</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListIndex"><span class="hs-identifier">YieldListIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListRefInputIndex"><span class="hs-identifier">YieldListRefInputIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldingRedeemer"><span class="hs-identifier">YieldingRedeemer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldingRedeemer"><span class="hs-identifier">YieldingRedeemer</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#getYieldedToHash"><span class="hs-identifier">getYieldedToHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html"><span class="hs-identifier">Cardano.YTxP.Control.YieldList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html#PYieldedToHash"><span class="hs-identifier">PYieldedToHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html#getYieldedToHashByIndex"><span class="hs-identifier">getYieldedToHashByIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.MintingPolicy.html"><span class="hs-identifier">Cardano.YTxP.Control.YieldList.MintingPolicy</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.MintingPolicy.html#YieldListSTCS"><span class="hs-identifier">YieldListSTCS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.MintingPolicy.html#pcontainsYieldListSTT"><span class="hs-identifier">pcontainsYieldListSTT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Api.V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PTxInInfo</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.DataRepr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PDataFields</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Utils.html"><span class="hs-identifier">Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Utils.html#punsafeFromInlineDatum"><span class="hs-identifier">punsafeFromInlineDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="annot"><span class="hs-comment">-- | Represents an index into a YieldList</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">newtype</span><span> </span><span id="YieldListIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListIndex"><span class="hs-identifier hs-var">YieldListIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="YieldListIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListIndex"><span class="hs-identifier hs-var">YieldListIndex</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- FIXME Int/Integer/Positive</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">newtype</span><span> </span><span id="PYieldListIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListIndex"><span class="hs-identifier hs-var">PYieldListIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273248"><span class="annot"><a href="#local-6989586621679273248"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PYieldListIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListIndex"><span class="hs-identifier hs-var">PYieldListIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679273248"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273251"><span id="local-6989586621679273253"><span class="annot"><span class="annottext">(forall x. PYieldListIndex s -&gt; Rep (PYieldListIndex s) x)
-&gt; (forall x. Rep (PYieldListIndex s) x -&gt; PYieldListIndex s)
-&gt; Generic (PYieldListIndex s)
forall x. Rep (PYieldListIndex s) x -&gt; PYieldListIndex s
forall x. PYieldListIndex s -&gt; Rep (PYieldListIndex s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x. Rep (PYieldListIndex s) x -&gt; PYieldListIndex s
forall (s :: S) x. PYieldListIndex s -&gt; Rep (PYieldListIndex s) x
$cfrom :: forall (s :: S) x. PYieldListIndex s -&gt; Rep (PYieldListIndex s) x
from :: forall x. PYieldListIndex s -&gt; Rep (PYieldListIndex s) x
$cto :: forall (s :: S) x. Rep (PYieldListIndex s) x -&gt; PYieldListIndex s
to :: forall x. Rep (PYieldListIndex s) x -&gt; PYieldListIndex s
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273257"><span id="local-6989586621679273263"><span class="annot"><span class="annottext">(forall (s :: S).
 PYieldListIndex s -&gt; Term s (PInner PYieldListIndex))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PYieldListIndex)
    -&gt; (PYieldListIndex s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PYieldListIndex
forall (s :: S).
PYieldListIndex s -&gt; Term s (PInner PYieldListIndex)
forall (s :: S) (b :: PType).
Term s (PInner PYieldListIndex)
-&gt; (PYieldListIndex s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
(forall (s :: S). a s -&gt; Term s (PInner a))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
$cpcon' :: forall (s :: S).
PYieldListIndex s -&gt; Term s (PInner PYieldListIndex)
pcon' :: forall (s :: S).
PYieldListIndex s -&gt; Term s (PInner PYieldListIndex)
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldListIndex)
-&gt; (PYieldListIndex s -&gt; Term s b) -&gt; Term s b
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldListIndex)
-&gt; (PYieldListIndex s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679273268"><span id="local-6989586621679273274"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex)
-&gt; (forall (s :: S). Term s PYieldListIndex -&gt; Term s PData)
-&gt; PIsData PYieldListIndex
forall (s :: S).
Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex
forall (s :: S). Term s PYieldListIndex -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
$cpfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex
pfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex
$cpdataImpl :: forall (s :: S). Term s PYieldListIndex -&gt; Term s PData
pdataImpl :: forall (s :: S). Term s PYieldListIndex -&gt; Term s PData
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivePlutusType</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListIndex"><span class="hs-identifier hs-type">PYieldListIndex</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DPTStrat"><span class="annot"><span class="hs-identifier hs-var">DPTStrat</span></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTypeNewtype</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679273303"><span class="annot"><span class="hs-identifier hs-type">PTryFrom</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PAsData</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListIndex"><span class="hs-identifier hs-type">PYieldListIndex</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="annot"><span class="hs-comment">{- | Represents an index into a transaction.
What is being indexed depends by the yielding script pointed by the YieldListIndex.
  In case it a validator, this is an index into the transaction inputs for the input that triggers the yielded to validator
  In case it a minting policy, this is an index into the transaction mint for the asset class minted by the yielded to minting policy
  In case it a staking validator, this is an index into the transaction wdrl for the staking validator triggered by the yielded to staking validator
-}</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">newtype</span><span> </span><span id="YieldListScriptToYieldIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListScriptToYieldIndex"><span class="hs-identifier hs-var">YieldListScriptToYieldIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="YieldListScriptToYieldIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListScriptToYieldIndex"><span class="hs-identifier hs-var">YieldListScriptToYieldIndex</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- FIXME Int/Integer/Positive</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">newtype</span><span> </span><span id="PYieldListScriptToYieldIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListScriptToYieldIndex"><span class="hs-identifier hs-var">PYieldListScriptToYieldIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273315"><span class="annot"><a href="#local-6989586621679273315"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PYieldListScriptToYieldIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListScriptToYieldIndex"><span class="hs-identifier hs-var">PYieldListScriptToYieldIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679273315"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273318"><span id="local-6989586621679273320"><span class="annot"><span class="annottext">(forall x.
 PYieldListScriptToYieldIndex s
 -&gt; Rep (PYieldListScriptToYieldIndex s) x)
-&gt; (forall x.
    Rep (PYieldListScriptToYieldIndex s) x
    -&gt; PYieldListScriptToYieldIndex s)
-&gt; Generic (PYieldListScriptToYieldIndex s)
forall x.
Rep (PYieldListScriptToYieldIndex s) x
-&gt; PYieldListScriptToYieldIndex s
forall x.
PYieldListScriptToYieldIndex s
-&gt; Rep (PYieldListScriptToYieldIndex s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x.
Rep (PYieldListScriptToYieldIndex s) x
-&gt; PYieldListScriptToYieldIndex s
forall (s :: S) x.
PYieldListScriptToYieldIndex s
-&gt; Rep (PYieldListScriptToYieldIndex s) x
$cfrom :: forall (s :: S) x.
PYieldListScriptToYieldIndex s
-&gt; Rep (PYieldListScriptToYieldIndex s) x
from :: forall x.
PYieldListScriptToYieldIndex s
-&gt; Rep (PYieldListScriptToYieldIndex s) x
$cto :: forall (s :: S) x.
Rep (PYieldListScriptToYieldIndex s) x
-&gt; PYieldListScriptToYieldIndex s
to :: forall x.
Rep (PYieldListScriptToYieldIndex s) x
-&gt; PYieldListScriptToYieldIndex s
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273323"><span id="local-6989586621679273329"><span class="annot"><span class="annottext">(forall (s :: S).
 PYieldListScriptToYieldIndex s
 -&gt; Term s (PInner PYieldListScriptToYieldIndex))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PYieldListScriptToYieldIndex)
    -&gt; (PYieldListScriptToYieldIndex s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PYieldListScriptToYieldIndex
forall (s :: S).
PYieldListScriptToYieldIndex s
-&gt; Term s (PInner PYieldListScriptToYieldIndex)
forall (s :: S) (b :: PType).
Term s (PInner PYieldListScriptToYieldIndex)
-&gt; (PYieldListScriptToYieldIndex s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
(forall (s :: S). a s -&gt; Term s (PInner a))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
$cpcon' :: forall (s :: S).
PYieldListScriptToYieldIndex s
-&gt; Term s (PInner PYieldListScriptToYieldIndex)
pcon' :: forall (s :: S).
PYieldListScriptToYieldIndex s
-&gt; Term s (PInner PYieldListScriptToYieldIndex)
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldListScriptToYieldIndex)
-&gt; (PYieldListScriptToYieldIndex s -&gt; Term s b) -&gt; Term s b
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldListScriptToYieldIndex)
-&gt; (PYieldListScriptToYieldIndex s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679273333"><span id="local-6989586621679273339"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PYieldListScriptToYieldIndex)
 -&gt; Term s PYieldListScriptToYieldIndex)
-&gt; (forall (s :: S).
    Term s PYieldListScriptToYieldIndex -&gt; Term s PData)
-&gt; PIsData PYieldListScriptToYieldIndex
forall (s :: S).
Term s (PAsData PYieldListScriptToYieldIndex)
-&gt; Term s PYieldListScriptToYieldIndex
forall (s :: S).
Term s PYieldListScriptToYieldIndex -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
$cpfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldListScriptToYieldIndex)
-&gt; Term s PYieldListScriptToYieldIndex
pfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldListScriptToYieldIndex)
-&gt; Term s PYieldListScriptToYieldIndex
$cpdataImpl :: forall (s :: S).
Term s PYieldListScriptToYieldIndex -&gt; Term s PData
pdataImpl :: forall (s :: S).
Term s PYieldListScriptToYieldIndex -&gt; Term s PData
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivePlutusType</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListScriptToYieldIndex"><span class="hs-identifier hs-type">PYieldListScriptToYieldIndex</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DPTStrat"><span class="annot"><span class="hs-identifier hs-var">DPTStrat</span></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTypeNewtype</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679273362"><span class="annot"><span class="hs-identifier hs-type">PTryFrom</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PAsData</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListScriptToYieldIndex"><span class="hs-identifier hs-type">PYieldListScriptToYieldIndex</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">{- | Represents an index into reference inputs of a transaction.
The UTxO at this index must contain a YieldListSTT; otherwise, we blow up
-}</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">newtype</span><span> </span><span id="YieldListRefInputIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListRefInputIndex"><span class="hs-identifier hs-var">YieldListRefInputIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="YieldListRefInputIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListRefInputIndex"><span class="hs-identifier hs-var">YieldListRefInputIndex</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.5/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- FIXME Int/Integer/Positive</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">newtype</span><span> </span><span id="PYieldListRefInputIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListRefInputIndex"><span class="hs-identifier hs-var">PYieldListRefInputIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273372"><span class="annot"><a href="#local-6989586621679273372"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PYieldListRefInputIndex"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListRefInputIndex"><span class="hs-identifier hs-var">PYieldListRefInputIndex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span> </span><span class="annot"><a href="#local-6989586621679273372"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273375"><span id="local-6989586621679273377"><span class="annot"><span class="annottext">(forall x.
 PYieldListRefInputIndex s -&gt; Rep (PYieldListRefInputIndex s) x)
-&gt; (forall x.
    Rep (PYieldListRefInputIndex s) x -&gt; PYieldListRefInputIndex s)
-&gt; Generic (PYieldListRefInputIndex s)
forall x.
Rep (PYieldListRefInputIndex s) x -&gt; PYieldListRefInputIndex s
forall x.
PYieldListRefInputIndex s -&gt; Rep (PYieldListRefInputIndex s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x.
Rep (PYieldListRefInputIndex s) x -&gt; PYieldListRefInputIndex s
forall (s :: S) x.
PYieldListRefInputIndex s -&gt; Rep (PYieldListRefInputIndex s) x
$cfrom :: forall (s :: S) x.
PYieldListRefInputIndex s -&gt; Rep (PYieldListRefInputIndex s) x
from :: forall x.
PYieldListRefInputIndex s -&gt; Rep (PYieldListRefInputIndex s) x
$cto :: forall (s :: S) x.
Rep (PYieldListRefInputIndex s) x -&gt; PYieldListRefInputIndex s
to :: forall x.
Rep (PYieldListRefInputIndex s) x -&gt; PYieldListRefInputIndex s
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273380"><span id="local-6989586621679273386"><span class="annot"><span class="annottext">(forall (s :: S).
 PYieldListRefInputIndex s
 -&gt; Term s (PInner PYieldListRefInputIndex))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PYieldListRefInputIndex)
    -&gt; (PYieldListRefInputIndex s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PYieldListRefInputIndex
forall (s :: S).
PYieldListRefInputIndex s
-&gt; Term s (PInner PYieldListRefInputIndex)
forall (s :: S) (b :: PType).
Term s (PInner PYieldListRefInputIndex)
-&gt; (PYieldListRefInputIndex s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
(forall (s :: S). a s -&gt; Term s (PInner a))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
$cpcon' :: forall (s :: S).
PYieldListRefInputIndex s
-&gt; Term s (PInner PYieldListRefInputIndex)
pcon' :: forall (s :: S).
PYieldListRefInputIndex s
-&gt; Term s (PInner PYieldListRefInputIndex)
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldListRefInputIndex)
-&gt; (PYieldListRefInputIndex s -&gt; Term s b) -&gt; Term s b
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldListRefInputIndex)
-&gt; (PYieldListRefInputIndex s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679273390"><span id="local-6989586621679273396"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PYieldListRefInputIndex)
 -&gt; Term s PYieldListRefInputIndex)
-&gt; (forall (s :: S).
    Term s PYieldListRefInputIndex -&gt; Term s PData)
-&gt; PIsData PYieldListRefInputIndex
forall (s :: S).
Term s (PAsData PYieldListRefInputIndex)
-&gt; Term s PYieldListRefInputIndex
forall (s :: S). Term s PYieldListRefInputIndex -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
$cpfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldListRefInputIndex)
-&gt; Term s PYieldListRefInputIndex
pfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldListRefInputIndex)
-&gt; Term s PYieldListRefInputIndex
$cpdataImpl :: forall (s :: S). Term s PYieldListRefInputIndex -&gt; Term s PData
pdataImpl :: forall (s :: S). Term s PYieldListRefInputIndex -&gt; Term s PData
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivePlutusType</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListRefInputIndex"><span class="hs-identifier hs-type">PYieldListRefInputIndex</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DPTStrat"><span class="annot"><span class="hs-identifier hs-var">DPTStrat</span></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTypeNewtype</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679273419"><span class="annot"><span class="hs-identifier hs-type">PTryFrom</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PAsData</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListRefInputIndex"><span class="hs-identifier hs-type">PYieldListRefInputIndex</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">{- | The redeemer passed to the yielding minting policy, validator,
and staking validators
-}</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="YieldingRedeemer"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldingRedeemer"><span class="hs-identifier hs-var">YieldingRedeemer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="YieldingRedeemer"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldingRedeemer"><span class="hs-identifier hs-var">YieldingRedeemer</span></a></span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AyieldListIndex%3AYieldingRedeemer"><span class="annot"><span class="annottext">YieldingRedeemer -&gt; YieldListIndex
</span><a href="Cardano.YTxP.Control.Yielding.html#%24sel%3AyieldListIndex%3AYieldingRedeemer"><span class="hs-identifier hs-var hs-var">yieldListIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListIndex"><span class="hs-identifier hs-type">YieldListIndex</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">-- ^ The index into the YieldList itself. Used to prevent yielding scripts from</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- needing to inspect each entry for equality; we _only_ look at this index,</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">-- check equality, and blow up if it doesn't match.</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AyieldListScriptToYieldIndex%3AYieldingRedeemer"><span class="annot"><span class="annottext">YieldingRedeemer -&gt; YieldListScriptToYieldIndex
</span><a href="Cardano.YTxP.Control.Yielding.html#%24sel%3AyieldListScriptToYieldIndex%3AYieldingRedeemer"><span class="hs-identifier hs-var hs-var">yieldListScriptToYieldIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListScriptToYieldIndex"><span class="hs-identifier hs-type">YieldListScriptToYieldIndex</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- ^ The index into the transaction for the script pointed to by the yieldListIndex.</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- This allows us to avoid having to loop through inputs/mints/withdrawls to find the</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- script we want to ensure is run.</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AyieldListRefInputIndex%3AYieldingRedeemer"><span class="annot"><span class="annottext">YieldingRedeemer -&gt; YieldListRefInputIndex
</span><a href="Cardano.YTxP.Control.Yielding.html#%24sel%3AyieldListRefInputIndex%3AYieldingRedeemer"><span class="hs-identifier hs-var hs-var">yieldListRefInputIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#YieldListRefInputIndex"><span class="hs-identifier hs-type">YieldListRefInputIndex</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">-- ^ The index into the reference inputs of the transaction where the correct</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- YieldList UTxO will be found. We use this to prevent yielding scripts from</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">-- needing to inspect each reference UTxO for equality; we only look at this</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">-- index, and blow up if it doesn't contain the correct STT.</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">newtype</span><span> </span><span id="PYieldingRedeemer"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldingRedeemer"><span class="hs-identifier hs-var">PYieldingRedeemer</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273431"><span class="annot"><a href="#local-6989586621679273431"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PYieldingRedeemer"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldingRedeemer"><span class="hs-identifier hs-var">PYieldingRedeemer</span></a></span></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span>
</span><span id="line-86"></span><span>          </span><span class="annot"><a href="#local-6989586621679273431"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-87"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PDataRecord</span></span><span>
</span><span id="line-88"></span><span>              </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;yieldListIndex&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListIndex"><span class="hs-identifier hs-type">PYieldListIndex</span></a></span><span>
</span><span id="line-89"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;yieldListScriptToYieldIndex&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListScriptToYieldIndex"><span class="hs-identifier hs-type">PYieldListScriptToYieldIndex</span></a></span><span>
</span><span id="line-90"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;yieldListRefInputIndex&quot;</span></span><span> </span><span class="hs-special">'</span><span class="hs-operator">:=</span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldListRefInputIndex"><span class="hs-identifier hs-type">PYieldListRefInputIndex</span></a></span><span>
</span><span id="line-91"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273434"><span id="local-6989586621679273436"><span class="annot"><span class="annottext">(forall x. PYieldingRedeemer s -&gt; Rep (PYieldingRedeemer s) x)
-&gt; (forall x. Rep (PYieldingRedeemer s) x -&gt; PYieldingRedeemer s)
-&gt; Generic (PYieldingRedeemer s)
forall x. Rep (PYieldingRedeemer s) x -&gt; PYieldingRedeemer s
forall x. PYieldingRedeemer s -&gt; Rep (PYieldingRedeemer s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (s :: S) x.
Rep (PYieldingRedeemer s) x -&gt; PYieldingRedeemer s
forall (s :: S) x.
PYieldingRedeemer s -&gt; Rep (PYieldingRedeemer s) x
$cfrom :: forall (s :: S) x.
PYieldingRedeemer s -&gt; Rep (PYieldingRedeemer s) x
from :: forall x. PYieldingRedeemer s -&gt; Rep (PYieldingRedeemer s) x
$cto :: forall (s :: S) x.
Rep (PYieldingRedeemer s) x -&gt; PYieldingRedeemer s
to :: forall x. Rep (PYieldingRedeemer s) x -&gt; PYieldingRedeemer s
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679273439"><span id="local-6989586621679273445"><span class="annot"><span class="annottext">(forall (s :: S).
 PYieldingRedeemer s -&gt; Term s (PInner PYieldingRedeemer))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner PYieldingRedeemer)
    -&gt; (PYieldingRedeemer s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType PYieldingRedeemer
forall (s :: S).
PYieldingRedeemer s -&gt; Term s (PInner PYieldingRedeemer)
forall (s :: S) (b :: PType).
Term s (PInner PYieldingRedeemer)
-&gt; (PYieldingRedeemer s -&gt; Term s b) -&gt; Term s b
forall (a :: PType).
(forall (s :: S). a s -&gt; Term s (PInner a))
-&gt; (forall (s :: S) (b :: PType).
    Term s (PInner a) -&gt; (a s -&gt; Term s b) -&gt; Term s b)
-&gt; PlutusType a
$cpcon' :: forall (s :: S).
PYieldingRedeemer s -&gt; Term s (PInner PYieldingRedeemer)
pcon' :: forall (s :: S).
PYieldingRedeemer s -&gt; Term s (PInner PYieldingRedeemer)
$cpmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldingRedeemer)
-&gt; (PYieldingRedeemer s -&gt; Term s b) -&gt; Term s b
pmatch' :: forall (s :: S) (b :: PType).
Term s (PInner PYieldingRedeemer)
-&gt; (PYieldingRedeemer s -&gt; Term s b) -&gt; Term s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PlutusType</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679273449"><span id="local-6989586621679273455"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s (PAsData PYieldingRedeemer) -&gt; Term s PYieldingRedeemer)
-&gt; (forall (s :: S). Term s PYieldingRedeemer -&gt; Term s PData)
-&gt; PIsData PYieldingRedeemer
forall (s :: S).
Term s (PAsData PYieldingRedeemer) -&gt; Term s PYieldingRedeemer
forall (s :: S). Term s PYieldingRedeemer -&gt; Term s PData
forall (a :: PType).
(forall (s :: S). Term s (PAsData a) -&gt; Term s a)
-&gt; (forall (s :: S). Term s a -&gt; Term s PData) -&gt; PIsData a
$cpfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldingRedeemer) -&gt; Term s PYieldingRedeemer
pfromDataImpl :: forall (s :: S).
Term s (PAsData PYieldingRedeemer) -&gt; Term s PYieldingRedeemer
$cpdataImpl :: forall (s :: S). Term s PYieldingRedeemer -&gt; Term s PData
pdataImpl :: forall (s :: S). Term s PYieldingRedeemer -&gt; Term s PData
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">PIsData</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679273461"><span class="annot"><span class="annottext">(forall (s :: S).
 Term s PYieldingRedeemer
 -&gt; Term s (PDataRecord (PFields PYieldingRedeemer)))
-&gt; PDataFields PYieldingRedeemer
forall (s :: S).
Term s PYieldingRedeemer
-&gt; Term s (PDataRecord (PFields PYieldingRedeemer))
forall (a :: PType).
(forall (s :: S). Term s a -&gt; Term s (PDataRecord (PFields a)))
-&gt; PDataFields a
$cptoFields :: forall (s :: S).
Term s PYieldingRedeemer
-&gt; Term s (PDataRecord (PFields PYieldingRedeemer))
ptoFields :: forall (s :: S).
Term s PYieldingRedeemer
-&gt; Term s (PDataRecord (PFields PYieldingRedeemer))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">PDataFields</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivePlutusType</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldingRedeemer"><span class="hs-identifier hs-type">PYieldingRedeemer</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DPTStrat"><span class="annot"><span class="hs-identifier hs-var">DPTStrat</span></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PlutusTypeData</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679273501"><span class="annot"><span class="hs-identifier hs-type">PTryFrom</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PAsData</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldingRedeemer"><span class="hs-identifier hs-type">PYieldingRedeemer</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><span class="hs-comment">{- | Given a list of reference inputs and a Yielding Redeemer, dig out the
YieldList by:
- Indexing the reference inputs according to the redeemer
- Checking the fetched reference input for the correct YieldListSTCS
- Decoding its datum (unsafely; the presence of the YieldListSTCS ensure it is authentic and well-formed)
- Looking in the datum at the index in the redeemer and returning the YieldedToHash
-}</span></span><span>
</span><span id="line-109"></span><span id="local-6989586621679273113"><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#getYieldedToHash"><span class="hs-identifier hs-type">getYieldedToHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.MintingPolicy.html#YieldListSTCS"><span class="hs-identifier hs-type">YieldListSTCS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Term</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="#local-6989586621679273113"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PBuiltinList</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PTxInInfo</span></span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.Yielding.html#PYieldingRedeemer"><span class="hs-identifier hs-type">PYieldingRedeemer</span></a></span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="Cardano.YTxP.Control.YieldList.html#PYieldedToHash"><span class="hs-identifier hs-type">PYieldedToHash</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">)</span></span><span>
</span><span id="line-117"></span><span id="getYieldedToHash"><span class="annot"><span class="annottext">getYieldedToHash :: forall (s :: S).
YieldListSTCS
-&gt; Term
     s
     (PBuiltinList PTxInInfo
      :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
</span><a href="Cardano.YTxP.Control.Yielding.html#getYieldedToHash"><span class="hs-identifier hs-var hs-var">getYieldedToHash</span></a></span></span><span> </span><span id="local-6989586621679273543"><span class="annot"><span class="annottext">YieldListSTCS
</span><a href="#local-6989586621679273543"><span class="hs-identifier hs-var">yieldListSTCS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (PBuiltinList PTxInInfo
   :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
-&gt; Term
     s
     (PBuiltinList PTxInInfo
      :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
forall (a :: PType) (s :: S).
HasCallStack =&gt;
ClosedTerm a -&gt; Term s a
</span><span class="hs-identifier hs-var">phoistAcyclic</span></span><span> </span><span class="annot"><span class="annottext">(ClosedTerm
   (PBuiltinList PTxInInfo
    :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
 -&gt; Term
      s
      (PBuiltinList PTxInInfo
       :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash)))
-&gt; ClosedTerm
     (PBuiltinList PTxInInfo
      :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
-&gt; Term
     s
     (PBuiltinList PTxInInfo
      :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="annottext">(Term s (PBuiltinList PTxInInfo)
 -&gt; Term s PYieldingRedeemer -&gt; Term s PYieldedToHash)
-&gt; Term
     s
     (PBuiltinList PTxInInfo
      :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
forall a (b :: PType) (s :: S) (c :: PType).
(PLamN a b s, HasCallStack) =&gt;
(Term s c -&gt; a) -&gt; Term s (c :--&gt; b)
forall (c :: PType).
HasCallStack =&gt;
(Term s c -&gt; Term s PYieldingRedeemer -&gt; Term s PYieldedToHash)
-&gt; Term s (c :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
</span><span class="hs-identifier hs-var">plam</span></span><span> </span><span class="annot"><span class="annottext">((Term s (PBuiltinList PTxInInfo)
  -&gt; Term s PYieldingRedeemer -&gt; Term s PYieldedToHash)
 -&gt; Term
      s
      (PBuiltinList PTxInInfo
       :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash)))
-&gt; (Term s (PBuiltinList PTxInInfo)
    -&gt; Term s PYieldingRedeemer -&gt; Term s PYieldedToHash)
-&gt; Term
     s
     (PBuiltinList PTxInInfo
      :--&gt; (PYieldingRedeemer :--&gt; PYieldedToHash))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679273635"><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679273635"><span class="hs-identifier hs-var">txInfoRefInputs</span></a></span></span><span> </span><span id="local-6989586621679273636"><span class="annot"><span class="annottext">Term s PYieldingRedeemer
</span><a href="#local-6989586621679273636"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TermCont @PYieldedToHash s (Term s PYieldedToHash)
-&gt; Term s PYieldedToHash
forall (a :: PType) (s :: S). TermCont @a s (Term s a) -&gt; Term s a
</span><span class="hs-identifier hs-var">unTermCont</span></span><span> </span><span class="annot"><span class="annottext">(TermCont @PYieldedToHash s (Term s PYieldedToHash)
 -&gt; Term s PYieldedToHash)
-&gt; TermCont @PYieldedToHash s (Term s PYieldedToHash)
-&gt; Term s PYieldedToHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-comment">-- TODO (OPTIMIZE): these values only get used once, can be a `let`</span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621679273638"><span class="annot"><span class="annottext">HRec
  (BoundTerms
     (PFields PYieldingRedeemer)
     (Bindings
        (PFields PYieldingRedeemer)
        ((':)
           @Symbol
           &quot;yieldListIndex&quot;
           ((':) @Symbol &quot;yieldListRefInputIndex&quot; ('[] @Symbol))))
     s)
</span><a href="#local-6989586621679273638"><span class="hs-identifier hs-var">yieldingRedeemer</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">forall (fs :: [Symbol]) (a :: PType) (s :: S) (b :: PType)
       (ps :: [PLabeledType]) (bs :: [ToBind]).
(PDataFields a,
 (ps :: [PLabeledType]) ~ (PFields a :: [PLabeledType]),
 (bs :: [ToBind]) ~ (Bindings ps fs :: [ToBind]),
 BindFields ps bs) =&gt;
Term s a -&gt; TermCont @b s (HRec (BoundTerms ps bs s))
</span><span class="hs-identifier hs-var">pletFieldsC</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;yieldListIndex&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;yieldListRefInputIndex&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term s PYieldingRedeemer
</span><a href="#local-6989586621679273636"><span class="hs-identifier hs-var">redeemer</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679273640"><span class="annot"><span class="annottext">yieldListUTxO :: Term s PTxInInfo
</span><a href="#local-6989586621679273640"><span class="hs-identifier hs-var hs-var">yieldListUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">Term s (PBuiltinList PTxInInfo)
</span><a href="#local-6989586621679273635"><span class="hs-identifier hs-var">txInfoRefInputs</span></a></span><span class="hs-cpp">
              #!! pto (pfromData $ getField @&quot;yieldListRefInputIndex&quot; yieldingRedeemer)
</span><span>          </span><span id="local-6989586621679273644"><span class="annot"><span class="annottext">output :: Term s (PAsData PTxOut)
</span><a href="#local-6989586621679273644"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;resolved&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PTxInInfo :--&gt; PAsData PTxOut)
-&gt; Term s PTxInInfo -&gt; Term s (PAsData PTxOut)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PTxInInfo
</span><a href="#local-6989586621679273640"><span class="hs-identifier hs-var">yieldListUTxO</span></a></span><span>
</span><span id="line-128"></span><span>          </span><span id="local-6989586621679273647"><span class="annot"><span class="annottext">value :: Term s (PValue 'Sorted 'Positive)
</span><a href="#local-6989586621679273647"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxOut :--&gt; PValue 'Sorted 'Positive)
-&gt; Term s (PAsData PTxOut) -&gt; Term s (PValue 'Sorted 'Positive)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxOut)
</span><a href="#local-6989586621679273644"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Term s PYieldedToHash
-&gt; TermCont @PYieldedToHash s (Term s PYieldedToHash)
forall a. a -&gt; TermCont @PYieldedToHash s a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Term s PYieldedToHash
 -&gt; TermCont @PYieldedToHash s (Term s PYieldedToHash))
-&gt; Term s PYieldedToHash
-&gt; TermCont @PYieldedToHash s (Term s PYieldedToHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">Term s PBool
-&gt; Term s PYieldedToHash
-&gt; Term s PYieldedToHash
-&gt; Term s PYieldedToHash
forall (s :: S) (a :: PType).
Term s PBool -&gt; Term s a -&gt; Term s a -&gt; Term s a
</span><span class="hs-identifier hs-var">pif</span></span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">YieldListSTCS -&gt; Term s (PValue 'Sorted 'Positive :--&gt; PBool)
forall (s :: S) (anyKey :: KeyGuarantees)
       (anyAmount :: AmountGuarantees).
YieldListSTCS -&gt; Term s (PValue anyKey anyAmount :--&gt; PBool)
</span><a href="Cardano.YTxP.Control.YieldList.MintingPolicy.html#pcontainsYieldListSTT"><span class="hs-identifier hs-var">pcontainsYieldListSTT</span></a></span><span> </span><span class="annot"><span class="annottext">YieldListSTCS
</span><a href="#local-6989586621679273543"><span class="hs-identifier hs-var">yieldListSTCS</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PValue 'Sorted 'Positive :--&gt; PBool)
-&gt; Term s (PValue 'Sorted 'Positive) -&gt; Term s PBool
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PValue 'Sorted 'Positive)
</span><a href="#local-6989586621679273647"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679273649"><span class="annot"><span class="annottext">datum :: Term s POutputDatum
</span><a href="#local-6989586621679273649"><span class="hs-identifier hs-var hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PAsData POutputDatum) -&gt; Term s POutputDatum
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData POutputDatum) -&gt; Term s POutputDatum)
-&gt; Term s (PAsData POutputDatum) -&gt; Term s POutputDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (name :: Symbol) (b :: PType) (p :: PType) (s :: S)
       (a :: PType) (as :: [PLabeledType]) (n :: Nat).
(PDataFields p,
 (as :: [PLabeledType]) ~ (PFields p :: [PLabeledType]),
 (n :: Nat) ~ (PLabelIndex name as :: Nat), KnownNat n,
 (a :: PType) ~ (PUnLabel (IndexList @PLabeledType n as) :: PType),
 PFromDataable a b) =&gt;
Term s (p :--&gt; b)
</span><span class="hs-identifier hs-var">pfield</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxOut :--&gt; PAsData POutputDatum)
-&gt; Term s (PAsData PTxOut) -&gt; Term s (PAsData POutputDatum)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PTxOut)
</span><a href="#local-6989586621679273644"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-134"></span><span>                </span><span id="local-6989586621679273650"><span class="annot"><span class="annottext">ylDatum :: Term s PYieldListDatum
</span><a href="#local-6989586621679273650"><span class="hs-identifier hs-var hs-var">ylDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (POutputDatum :--&gt; PYieldListDatum)
forall (s :: S) (a :: PType). Term s (POutputDatum :--&gt; a)
</span><a href="Utils.html#punsafeFromInlineDatum"><span class="hs-identifier hs-var">punsafeFromInlineDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (POutputDatum :--&gt; PYieldListDatum)
-&gt; Term s POutputDatum -&gt; Term s PYieldListDatum
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s POutputDatum
</span><a href="#local-6989586621679273649"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-135"></span><span>                </span><span id="local-6989586621679273651"><span class="annot"><span class="annottext">ylIndex :: Term s PYieldListIndex
</span><a href="#local-6989586621679273651"><span class="hs-identifier hs-var hs-var">ylIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex
forall (a :: PType) (s :: S).
PIsData a =&gt;
Term s (PAsData a) -&gt; Term s a
</span><span class="hs-identifier hs-var">pfromData</span></span><span> </span><span class="annot"><span class="annottext">(Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex)
-&gt; Term s (PAsData PYieldListIndex) -&gt; Term s PYieldListIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (x :: k) r a. HasField @k x r a =&gt; r -&gt; a
forall (x :: Symbol) r a. HasField @Symbol x r a =&gt; r -&gt; a
</span><a href="../../../ghc-9.6.5/html/libraries/base-4.18.2.1/src/GHC.Records.html#getField"><span class="hs-identifier hs-var">getField</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;yieldListIndex&quot;</span></span><span> </span><span class="annot"><span class="annottext">HRec
  (BoundTerms
     (PFields PYieldingRedeemer)
     (Bindings
        (PFields PYieldingRedeemer)
        ((':)
           @Symbol
           &quot;yieldListIndex&quot;
           ((':) @Symbol &quot;yieldListRefInputIndex&quot; ('[] @Symbol))))
     s)
</span><a href="#local-6989586621679273638"><span class="hs-identifier hs-var">yieldingRedeemer</span></a></span><span>
</span><span id="line-136"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Term s (PYieldListDatum :--&gt; (PInteger :--&gt; PYieldedToHash))
forall (s :: S).
Term s (PYieldListDatum :--&gt; (PInteger :--&gt; PYieldedToHash))
</span><a href="Cardano.YTxP.Control.YieldList.html#getYieldedToHashByIndex"><span class="hs-identifier hs-var">getYieldedToHashByIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PYieldListDatum :--&gt; (PInteger :--&gt; PYieldedToHash))
-&gt; Term s PYieldListDatum -&gt; Term s (PInteger :--&gt; PYieldedToHash)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PYieldListDatum
</span><a href="#local-6989586621679273650"><span class="hs-identifier hs-var">ylDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (PInteger :--&gt; PYieldedToHash)
-&gt; Term s PInteger -&gt; Term s PYieldedToHash
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">Term s PYieldListIndex -&gt; Term s (PInner PYieldListIndex)
forall (s :: S) (a :: PType). Term s a -&gt; Term s (PInner a)
</span><span class="hs-identifier hs-var">pto</span></span><span> </span><span class="annot"><span class="annottext">Term s PYieldListIndex
</span><a href="#local-6989586621679273651"><span class="hs-identifier hs-var">ylIndex</span></a></span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s PString -&gt; Term s PYieldedToHash
forall (s :: S) (a :: PType). Term s PString -&gt; Term s a
</span><span class="hs-identifier hs-var">ptraceError</span></span><span> </span><span class="annot"><span class="annottext">Term s PString
</span><span class="hs-string">&quot;getYieldedToHash: Reference input does not contain YieldListSTCS&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span></pre></body></html>