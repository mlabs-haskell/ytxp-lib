# Setting up direct offer YTxP

Welcome to this guide on setting up the YTxP yielding contracts required to operate transaction families. We'll use the direct-offer contract as a simple example to demonstrate how to effectively use YTxP.

Before diving in, ensure you have the following:

- [A solid understanding of the core concepts of YTxP](/docs/)
- [Familiarity with the direct offer specification](/ytxp-plutarch/examples/direct-offer/doc/README.md).
- Basic knowledge of Haskell and Cabal for compiling and running scripts.
- An understanding of how a script manager operates and how to build a simple one using state threads.

## Managing transaction families script

For YTxP, a script management system is essential for deploying transaction families. This involves locking a UTXO with a script using a state thread as proof of an authorized transaction family.

For this tutorial, we'll assume the state thread currency symbol used as proof is `ffff`. Feel free to replace this with your own currency symbol.

## Compiling yielding scripts

To compile the yielding scripts, you'll need to know your script authorization state thread token (in this case, `ffff`) and the yielding scripts you plan to use.

The direct offer consists of three transaction families, all triggered by minting the state thread for the offer component. This means you'll need one yielding spending script where the offer component lies, and one yielding minting policy for the component state thread token.

Use the following command to compile the yielding scripts:

```bash
cabal run ytxp -- -o ytxp.json -m 1 --stcs "ffff" --txf-purpose rewarding minting --traces
```

This command automatically creates a yielding validator script. The `-m 1` option indicates that you want one yielding minting policy script. The `--stcs "ffff"` option informs the YTxP compiler about the authorized script token. The `--txf-purpose rewarding minting` option specifies which script purposes are permitted for authenticated scripts.

## Deploying the scripts

You can deploy the yielding scripts on a script management system. Note that the authorized script token is explicitly used as proof of an authorized transaction family. Therefore, other state thread tokens must be used for any other scripts.

The direct offer transaction families can be compiled using the yielding validator script hash and the yielding minting policy symbol generated by the YTxP compiler.

## Conclusion

With the setup complete, you can now execute a transaction family using the yielding minting policy and yielding spending validator.

For the yielding script to succeed, you need to populate the yielding redeemer. This involves specifying the index of the authorized reference script (the transaction family), the yielding purpose, and the proof index. Specifically, for the yielding spending validator, if you need to reclaim the offer, you should declare Spending as your purpose and the index of the offer UTXO in txInfoInputs. For minting, declare the Minting purpose and the index position of your minting value in the txInfoMints field.

For more information on the yielding redeemer, check out [ytxp-sdk](https://github.com/mlabs-haskell/ytxp-lib/blob/master/ytxp-sdk/src/Cardano/YTxP/SDK/Redeemers.hs).
